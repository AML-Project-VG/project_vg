2022-01-14 06:55:49   Arguments: Namespace(backbone='resnet18', use_netvlad=True, netvlad_clusters=64, use_gem=None, gem_p=3, gem_eps=1e-06, use_sgd=None, use_adagrad=None, momentum=0.9, train_batch_size=4, infer_batch_size=16, margin=0.1, epochs_num=20, patience=3, lr=1e-06, cache_refresh_rate=1000, queries_per_epoch=5000, negs_num_per_query=10, neg_samples_num=1000, seed=0, device='cuda', num_workers=8, val_positive_dist_threshold=25, train_positives_dist_threshold=10, recall_values=[1, 5, 10, 20], datasets_folder='./Dataset_pitts30k', exp_name='default', test_dataset_name=None, test_model_path=None, output_folder='runs/default/2022-01-14_06-55-49')
2022-01-14 06:55:49   The outputs are being saved in runs/default/2022-01-14_06-55-49
2022-01-14 06:55:49   Using 1 GPUs and 12 CPUs
2022-01-14 06:55:49   Loading dataset Pitts30k from folder ./Dataset_pitts30k
2022-01-14 06:55:49   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-14 06:55:49   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-14 06:55:49   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-14 06:55:49   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-14 06:55:49   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-14 06:55:54   Output dimension of the model is 16384
2022-01-14 06:55:54   Start training epoch: 00
2022-01-14 06:55:54   Cache: 0 / 5
2022-01-14 06:58:46   Epoch[00](0/5): current batch triplet loss = 0.0814, average epoch triplet loss = 0.0844
2022-01-14 06:58:46   Cache: 1 / 5
2022-01-14 07:01:41   Epoch[00](1/5): current batch triplet loss = 0.0989, average epoch triplet loss = 0.0848
2022-01-14 07:01:41   Cache: 2 / 5
2022-01-14 07:04:33   Epoch[00](2/5): current batch triplet loss = 0.0872, average epoch triplet loss = 0.0845
2022-01-14 07:04:33   Cache: 3 / 5
2022-01-14 07:07:25   Epoch[00](3/5): current batch triplet loss = 0.0915, average epoch triplet loss = 0.0843
2022-01-14 07:07:25   Cache: 4 / 5
2022-01-14 07:10:17   Epoch[00](4/5): current batch triplet loss = 0.0953, average epoch triplet loss = 0.0840
2022-01-14 07:10:17   Finished epoch 00 in 0:14:22, average epoch triplet loss = 0.0840
2022-01-14 07:10:17   Extracting database features for evaluation/testing
2022-01-14 07:11:00   Extracting queries features for evaluation/testing
2022-01-14 07:12:03   Calculating recalls
2022-01-14 07:12:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 57.8, R@5: 75.8, R@10: 82.6, R@20: 88.0
2022-01-14 07:12:29   Improved: previous best R@5 = 0.0, current R@5 = 75.8
2022-01-14 07:12:29   Start training epoch: 01
2022-01-14 07:12:29   Cache: 0 / 5
2022-01-14 07:15:21   Epoch[01](0/5): current batch triplet loss = 0.0839, average epoch triplet loss = 0.0820
2022-01-14 07:15:21   Cache: 1 / 5
2022-01-14 07:18:13   Epoch[01](1/5): current batch triplet loss = 0.0806, average epoch triplet loss = 0.0819
2022-01-14 07:18:13   Cache: 2 / 5
2022-01-14 07:21:05   Epoch[01](2/5): current batch triplet loss = 0.0910, average epoch triplet loss = 0.0817
2022-01-14 07:21:05   Cache: 3 / 5
2022-01-14 07:23:57   Epoch[01](3/5): current batch triplet loss = 0.0714, average epoch triplet loss = 0.0817
2022-01-14 07:23:57   Cache: 4 / 5
2022-01-14 07:26:49   Epoch[01](4/5): current batch triplet loss = 0.0908, average epoch triplet loss = 0.0817
2022-01-14 07:26:49   Finished epoch 01 in 0:14:20, average epoch triplet loss = 0.0817
2022-01-14 07:26:49   Extracting database features for evaluation/testing
2022-01-14 07:27:35   Extracting queries features for evaluation/testing
2022-01-14 07:28:29   Calculating recalls
2022-01-14 07:28:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 66.2, R@5: 83.1, R@10: 88.3, R@20: 92.4
2022-01-14 07:28:55   Improved: previous best R@5 = 75.8, current R@5 = 83.1
2022-01-14 07:28:55   Start training epoch: 02
2022-01-14 07:28:55   Cache: 0 / 5
2022-01-14 07:31:48   Epoch[02](0/5): current batch triplet loss = 0.0888, average epoch triplet loss = 0.0810
2022-01-14 07:31:48   Cache: 1 / 5
2022-01-14 07:34:40   Epoch[02](1/5): current batch triplet loss = 0.0828, average epoch triplet loss = 0.0814
2022-01-14 07:34:40   Cache: 2 / 5
2022-01-14 07:37:33   Epoch[02](2/5): current batch triplet loss = 0.0614, average epoch triplet loss = 0.0812
2022-01-14 07:37:33   Cache: 3 / 5
2022-01-14 07:40:25   Epoch[02](3/5): current batch triplet loss = 0.0659, average epoch triplet loss = 0.0807
2022-01-14 07:40:25   Cache: 4 / 5
2022-01-14 07:43:17   Epoch[02](4/5): current batch triplet loss = 0.0818, average epoch triplet loss = 0.0807
2022-01-14 07:43:17   Finished epoch 02 in 0:14:22, average epoch triplet loss = 0.0807
2022-01-14 07:43:17   Extracting database features for evaluation/testing
2022-01-14 07:44:07   Extracting queries features for evaluation/testing
2022-01-14 07:45:10   Calculating recalls
2022-01-14 07:45:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 70.8, R@5: 86.3, R@10: 90.9, R@20: 94.3
2022-01-14 07:45:34   Improved: previous best R@5 = 83.1, current R@5 = 86.3
2022-01-14 07:45:34   Start training epoch: 03
2022-01-14 07:45:34   Cache: 0 / 5
2022-01-14 07:48:26   Epoch[03](0/5): current batch triplet loss = 0.0809, average epoch triplet loss = 0.0784
2022-01-14 07:48:26   Cache: 1 / 5
2022-01-14 07:51:18   Epoch[03](1/5): current batch triplet loss = 0.0781, average epoch triplet loss = 0.0793
2022-01-14 07:51:18   Cache: 2 / 5
2022-01-14 07:54:10   Epoch[03](2/5): current batch triplet loss = 0.0642, average epoch triplet loss = 0.0796
2022-01-14 07:54:10   Cache: 3 / 5
2022-01-14 07:57:02   Epoch[03](3/5): current batch triplet loss = 0.0901, average epoch triplet loss = 0.0796
2022-01-14 07:57:02   Cache: 4 / 5
2022-01-14 07:59:54   Epoch[03](4/5): current batch triplet loss = 0.0902, average epoch triplet loss = 0.0796
2022-01-14 07:59:54   Finished epoch 03 in 0:14:20, average epoch triplet loss = 0.0796
2022-01-14 07:59:54   Extracting database features for evaluation/testing
2022-01-14 08:00:35   Extracting queries features for evaluation/testing
2022-01-14 08:01:30   Calculating recalls
2022-01-14 08:01:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.3, R@5: 88.3, R@10: 92.3, R@20: 95.1
2022-01-14 08:01:56   Improved: previous best R@5 = 86.3, current R@5 = 88.3
2022-01-14 08:01:56   Start training epoch: 04
2022-01-14 08:01:56   Cache: 0 / 5
2022-01-14 08:04:47   Epoch[04](0/5): current batch triplet loss = 0.0762, average epoch triplet loss = 0.0803
2022-01-14 08:04:47   Cache: 1 / 5
2022-01-14 08:07:40   Epoch[04](1/5): current batch triplet loss = 0.0854, average epoch triplet loss = 0.0792
2022-01-14 08:07:40   Cache: 2 / 5
2022-01-14 08:10:32   Epoch[04](2/5): current batch triplet loss = 0.0809, average epoch triplet loss = 0.0794
2022-01-14 08:10:32   Cache: 3 / 5
2022-01-14 08:13:24   Epoch[04](3/5): current batch triplet loss = 0.0794, average epoch triplet loss = 0.0793
2022-01-14 08:13:24   Cache: 4 / 5
2022-01-14 08:16:16   Epoch[04](4/5): current batch triplet loss = 0.0864, average epoch triplet loss = 0.0793
2022-01-14 08:16:16   Finished epoch 04 in 0:14:19, average epoch triplet loss = 0.0793
2022-01-14 08:16:16   Extracting database features for evaluation/testing
2022-01-14 08:16:51   Extracting queries features for evaluation/testing
2022-01-14 08:17:46   Calculating recalls
2022-01-14 08:18:08   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.3, R@5: 89.5, R@10: 93.1, R@20: 95.8
2022-01-14 08:18:08   Improved: previous best R@5 = 88.3, current R@5 = 89.5
2022-01-14 08:18:08   Start training epoch: 05
2022-01-14 08:18:08   Cache: 0 / 5
2022-01-14 08:21:00   Epoch[05](0/5): current batch triplet loss = 0.0684, average epoch triplet loss = 0.0788
2022-01-14 08:21:00   Cache: 1 / 5
2022-01-14 08:23:52   Epoch[05](1/5): current batch triplet loss = 0.0668, average epoch triplet loss = 0.0783
2022-01-14 08:23:52   Cache: 2 / 5
2022-01-14 08:26:44   Epoch[05](2/5): current batch triplet loss = 0.0712, average epoch triplet loss = 0.0784
2022-01-14 08:26:44   Cache: 3 / 5
2022-01-14 08:29:36   Epoch[05](3/5): current batch triplet loss = 0.0426, average epoch triplet loss = 0.0781
2022-01-14 08:29:36   Cache: 4 / 5
2022-01-14 08:32:27   Epoch[05](4/5): current batch triplet loss = 0.0760, average epoch triplet loss = 0.0781
2022-01-14 08:32:27   Finished epoch 05 in 0:14:18, average epoch triplet loss = 0.0781
2022-01-14 08:32:27   Extracting database features for evaluation/testing
2022-01-14 08:33:08   Extracting queries features for evaluation/testing
2022-01-14 08:34:10   Calculating recalls
2022-01-14 08:34:36   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.9, R@5: 90.3, R@10: 93.8, R@20: 96.0
2022-01-14 08:34:37   Improved: previous best R@5 = 89.5, current R@5 = 90.3
2022-01-14 08:34:37   Start training epoch: 06
2022-01-14 08:34:37   Cache: 0 / 5
2022-01-14 08:37:29   Epoch[06](0/5): current batch triplet loss = 0.0911, average epoch triplet loss = 0.0781
2022-01-14 08:37:29   Cache: 1 / 5
2022-01-14 08:40:21   Epoch[06](1/5): current batch triplet loss = 0.0640, average epoch triplet loss = 0.0779
2022-01-14 08:40:21   Cache: 2 / 5
2022-01-14 08:43:13   Epoch[06](2/5): current batch triplet loss = 0.0381, average epoch triplet loss = 0.0774
2022-01-14 08:43:13   Cache: 3 / 5
2022-01-14 08:46:05   Epoch[06](3/5): current batch triplet loss = 0.0778, average epoch triplet loss = 0.0776
2022-01-14 08:46:05   Cache: 4 / 5
2022-01-14 08:48:57   Epoch[06](4/5): current batch triplet loss = 0.0719, average epoch triplet loss = 0.0776
2022-01-14 08:48:57   Finished epoch 06 in 0:14:20, average epoch triplet loss = 0.0776
2022-01-14 08:48:57   Extracting database features for evaluation/testing
2022-01-14 08:49:36   Extracting queries features for evaluation/testing
2022-01-14 08:50:39   Calculating recalls
2022-01-14 08:51:10   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.1, R@5: 90.9, R@10: 94.1, R@20: 96.3
2022-01-14 08:51:10   Improved: previous best R@5 = 90.3, current R@5 = 90.9
2022-01-14 08:51:10   Start training epoch: 07
2022-01-14 08:51:10   Cache: 0 / 5
2022-01-14 08:54:02   Epoch[07](0/5): current batch triplet loss = 0.0756, average epoch triplet loss = 0.0784
2022-01-14 08:54:02   Cache: 1 / 5
2022-01-14 08:56:55   Epoch[07](1/5): current batch triplet loss = 0.0499, average epoch triplet loss = 0.0765
2022-01-14 08:56:55   Cache: 2 / 5
2022-01-14 08:59:46   Epoch[07](2/5): current batch triplet loss = 0.0873, average epoch triplet loss = 0.0766
2022-01-14 08:59:46   Cache: 3 / 5
2022-01-14 09:02:38   Epoch[07](3/5): current batch triplet loss = 0.0807, average epoch triplet loss = 0.0770
2022-01-14 09:02:38   Cache: 4 / 5
2022-01-14 09:05:31   Epoch[07](4/5): current batch triplet loss = 0.0564, average epoch triplet loss = 0.0768
2022-01-14 09:05:31   Finished epoch 07 in 0:14:20, average epoch triplet loss = 0.0768
2022-01-14 09:05:31   Extracting database features for evaluation/testing
2022-01-14 09:06:06   Extracting queries features for evaluation/testing
2022-01-14 09:07:04   Calculating recalls
2022-01-14 09:07:30   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.0, R@5: 91.5, R@10: 94.3, R@20: 96.5
2022-01-14 09:07:31   Improved: previous best R@5 = 90.9, current R@5 = 91.5
2022-01-14 09:07:31   Start training epoch: 08
2022-01-14 09:07:31   Cache: 0 / 5
2022-01-14 09:10:22   Epoch[08](0/5): current batch triplet loss = 0.0815, average epoch triplet loss = 0.0771
2022-01-14 09:10:22   Cache: 1 / 5
2022-01-14 09:13:14   Epoch[08](1/5): current batch triplet loss = 0.0879, average epoch triplet loss = 0.0769
2022-01-14 09:13:14   Cache: 2 / 5
2022-01-14 09:16:06   Epoch[08](2/5): current batch triplet loss = 0.0702, average epoch triplet loss = 0.0770
2022-01-14 09:16:06   Cache: 3 / 5
2022-01-14 09:18:58   Epoch[08](3/5): current batch triplet loss = 0.0759, average epoch triplet loss = 0.0764
2022-01-14 09:18:58   Cache: 4 / 5
2022-01-14 09:21:50   Epoch[08](4/5): current batch triplet loss = 0.0753, average epoch triplet loss = 0.0762
2022-01-14 09:21:50   Finished epoch 08 in 0:14:19, average epoch triplet loss = 0.0762
2022-01-14 09:21:50   Extracting database features for evaluation/testing
2022-01-14 09:22:26   Extracting queries features for evaluation/testing
2022-01-14 09:23:28   Calculating recalls
2022-01-14 09:23:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 80.7, R@5: 91.9, R@10: 94.6, R@20: 96.7
2022-01-14 09:23:55   Improved: previous best R@5 = 91.5, current R@5 = 91.9
2022-01-14 09:23:55   Start training epoch: 09
2022-01-14 09:23:55   Cache: 0 / 5
2022-01-14 09:26:53   Epoch[09](0/5): current batch triplet loss = 0.0727, average epoch triplet loss = 0.0768
2022-01-14 09:26:53   Cache: 1 / 5
2022-01-14 09:29:55   Epoch[09](1/5): current batch triplet loss = 0.0596, average epoch triplet loss = 0.0758
2022-01-14 09:29:55   Cache: 2 / 5
2022-01-14 09:32:49   Epoch[09](2/5): current batch triplet loss = 0.0786, average epoch triplet loss = 0.0761
2022-01-14 09:32:49   Cache: 3 / 5
2022-01-14 09:35:42   Epoch[09](3/5): current batch triplet loss = 0.0709, average epoch triplet loss = 0.0759
2022-01-14 09:35:42   Cache: 4 / 5
2022-01-14 09:38:34   Epoch[09](4/5): current batch triplet loss = 0.0797, average epoch triplet loss = 0.0758
2022-01-14 09:38:34   Finished epoch 09 in 0:14:38, average epoch triplet loss = 0.0758
2022-01-14 09:38:34   Extracting database features for evaluation/testing
2022-01-14 09:39:09   Extracting queries features for evaluation/testing
2022-01-14 09:40:08   Calculating recalls
2022-01-14 09:40:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.1, R@5: 92.1, R@10: 94.8, R@20: 96.7
2022-01-14 09:40:34   Improved: previous best R@5 = 91.9, current R@5 = 92.1
2022-01-14 09:40:34   Start training epoch: 10
2022-01-14 09:40:34   Cache: 0 / 5
2022-01-14 09:43:26   Epoch[10](0/5): current batch triplet loss = 0.0581, average epoch triplet loss = 0.0748
2022-01-14 09:43:26   Cache: 1 / 5
2022-01-14 09:46:18   Epoch[10](1/5): current batch triplet loss = 0.0854, average epoch triplet loss = 0.0745
2022-01-14 09:46:18   Cache: 2 / 5
2022-01-14 09:49:10   Epoch[10](2/5): current batch triplet loss = 0.1017, average epoch triplet loss = 0.0743
2022-01-14 09:49:10   Cache: 3 / 5
2022-01-14 09:52:02   Epoch[10](3/5): current batch triplet loss = 0.0767, average epoch triplet loss = 0.0743
2022-01-14 09:52:02   Cache: 4 / 5
2022-01-14 09:54:54   Epoch[10](4/5): current batch triplet loss = 0.0667, average epoch triplet loss = 0.0743
2022-01-14 09:54:54   Finished epoch 10 in 0:14:19, average epoch triplet loss = 0.0743
2022-01-14 09:54:54   Extracting database features for evaluation/testing
2022-01-14 09:55:34   Extracting queries features for evaluation/testing
2022-01-14 09:56:33   Calculating recalls
2022-01-14 09:56:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.7, R@5: 92.5, R@10: 95.1, R@20: 96.9
2022-01-14 09:57:00   Improved: previous best R@5 = 92.1, current R@5 = 92.5
2022-01-14 09:57:00   Start training epoch: 11
2022-01-14 09:57:00   Cache: 0 / 5
2022-01-14 09:59:52   Epoch[11](0/5): current batch triplet loss = 0.0838, average epoch triplet loss = 0.0734
2022-01-14 09:59:52   Cache: 1 / 5
2022-01-14 10:02:45   Epoch[11](1/5): current batch triplet loss = 0.0725, average epoch triplet loss = 0.0740
2022-01-14 10:02:45   Cache: 2 / 5
2022-01-14 10:05:36   Epoch[11](2/5): current batch triplet loss = 0.0824, average epoch triplet loss = 0.0741
2022-01-14 10:05:36   Cache: 3 / 5
2022-01-14 10:08:29   Epoch[11](3/5): current batch triplet loss = 0.0733, average epoch triplet loss = 0.0744
2022-01-14 10:08:29   Cache: 4 / 5
2022-01-14 10:11:21   Epoch[11](4/5): current batch triplet loss = 0.0774, average epoch triplet loss = 0.0743
2022-01-14 10:11:21   Finished epoch 11 in 0:14:21, average epoch triplet loss = 0.0743
2022-01-14 10:11:21   Extracting database features for evaluation/testing
2022-01-14 10:11:57   Extracting queries features for evaluation/testing
2022-01-14 10:12:44   Calculating recalls
2022-01-14 10:13:05   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.8, R@5: 92.5, R@10: 95.0, R@20: 96.8
2022-01-14 10:13:06   Improved: previous best R@5 = 92.5, current R@5 = 92.5
2022-01-14 10:13:06   Start training epoch: 12
2022-01-14 10:13:06   Cache: 0 / 5
2022-01-14 10:16:02   Epoch[12](0/5): current batch triplet loss = 0.0855, average epoch triplet loss = 0.0725
2022-01-14 10:16:02   Cache: 1 / 5
2022-01-14 10:19:10   Epoch[12](1/5): current batch triplet loss = 0.0837, average epoch triplet loss = 0.0735
2022-01-14 10:19:10   Cache: 2 / 5
