2022-01-13 01:41:49   Arguments: Namespace(use_netvlad=None, netvlad_clusters=64, use_gem=True, gem_p=3, gem_eps=1e-06, use_sgd=None, use_adagrad=None, momentum=0.9, train_batch_size=4, infer_batch_size=16, margin=0.1, epochs_num=10, patience=3, lr=1e-05, cache_refresh_rate=1000, queries_per_epoch=5000, negs_num_per_query=10, neg_samples_num=1000, seed=0, device='cuda', num_workers=8, val_positive_dist_threshold=25, train_positives_dist_threshold=15, recall_values=[1, 5, 10, 20], datasets_folder='./Dataset_pitts30k', exp_name='default', test_dataset_name=None, test_model_path=None, output_folder='runs/default/2022-01-13_01-41-49')
2022-01-13 01:41:49   The outputs are being saved in runs/default/2022-01-13_01-41-49
2022-01-13 01:41:49   Using 1 GPUs and 12 CPUs
2022-01-13 01:41:49   Loading dataset Pitts30k from folder ./Dataset_pitts30k
2022-01-13 01:41:49   There are 48 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-13 01:41:49   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7368 >
2022-01-13 01:41:49   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-13 01:41:49   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-13 01:41:50   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-13 01:41:54   Output dimension of the model is 256
2022-01-13 01:41:54   Start training epoch: 00
2022-01-13 01:41:54   Cache: 0 / 5
2022-01-13 01:43:06   Epoch[00](0/5): current batch triplet loss = 0.0765, average epoch triplet loss = 0.0761
2022-01-13 01:43:06   Cache: 1 / 5
2022-01-13 01:44:20   Epoch[00](1/5): current batch triplet loss = 0.0762, average epoch triplet loss = 0.0735
2022-01-13 01:44:20   Cache: 2 / 5
2022-01-13 01:45:32   Epoch[00](2/5): current batch triplet loss = 0.0796, average epoch triplet loss = 0.0713
2022-01-13 01:45:32   Cache: 3 / 5
2022-01-13 01:46:45   Epoch[00](3/5): current batch triplet loss = 0.0678, average epoch triplet loss = 0.0696
2022-01-13 01:46:45   Cache: 4 / 5
2022-01-13 01:47:58   Epoch[00](4/5): current batch triplet loss = 0.0761, average epoch triplet loss = 0.0681
2022-01-13 01:47:58   Finished epoch 00 in 0:06:03, average epoch triplet loss = 0.0681
2022-01-13 01:47:58   Extracting database features for evaluation/testing
2022-01-13 01:48:23   Extracting queries features for evaluation/testing
2022-01-13 01:48:42   Calculating recalls
2022-01-13 01:48:42   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 54.2, R@5: 75.6, R@10: 83.2, R@20: 89.3
2022-01-13 01:48:42   Improved: previous best R@5 = 0.0, current R@5 = 75.6
2022-01-13 01:48:42   Start training epoch: 01
2022-01-13 01:48:42   Cache: 0 / 5
2022-01-13 01:49:56   Epoch[01](0/5): current batch triplet loss = 0.0680, average epoch triplet loss = 0.0607
2022-01-13 01:49:56   Cache: 1 / 5
2022-01-13 01:51:08   Epoch[01](1/5): current batch triplet loss = 0.0658, average epoch triplet loss = 0.0610
2022-01-13 01:51:08   Cache: 2 / 5
2022-01-13 01:52:20   Epoch[01](2/5): current batch triplet loss = 0.0595, average epoch triplet loss = 0.0602
2022-01-13 01:52:20   Cache: 3 / 5
2022-01-13 01:53:32   Epoch[01](3/5): current batch triplet loss = 0.0726, average epoch triplet loss = 0.0593
2022-01-13 01:53:32   Cache: 4 / 5
2022-01-13 01:54:44   Epoch[01](4/5): current batch triplet loss = 0.0603, average epoch triplet loss = 0.0583
2022-01-13 01:54:44   Finished epoch 01 in 0:06:01, average epoch triplet loss = 0.0583
2022-01-13 01:54:44   Extracting database features for evaluation/testing
2022-01-13 01:55:09   Extracting queries features for evaluation/testing
2022-01-13 01:55:28   Calculating recalls
2022-01-13 01:55:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 58.4, R@5: 78.1, R@10: 84.7, R@20: 90.2
2022-01-13 01:55:29   Improved: previous best R@5 = 75.6, current R@5 = 78.1
2022-01-13 01:55:29   Start training epoch: 02
2022-01-13 01:55:29   Cache: 0 / 5
2022-01-13 01:56:41   Epoch[02](0/5): current batch triplet loss = 0.0577, average epoch triplet loss = 0.0543
2022-01-13 01:56:41   Cache: 1 / 5
2022-01-13 01:57:53   Epoch[02](1/5): current batch triplet loss = 0.0609, average epoch triplet loss = 0.0534
2022-01-13 01:57:53   Cache: 2 / 5
2022-01-13 01:59:06   Epoch[02](2/5): current batch triplet loss = 0.0323, average epoch triplet loss = 0.0529
2022-01-13 01:59:06   Cache: 3 / 5
2022-01-13 02:00:18   Epoch[02](3/5): current batch triplet loss = 0.0503, average epoch triplet loss = 0.0524
2022-01-13 02:00:18   Cache: 4 / 5
2022-01-13 02:01:31   Epoch[02](4/5): current batch triplet loss = 0.0480, average epoch triplet loss = 0.0520
2022-01-13 02:01:31   Finished epoch 02 in 0:06:01, average epoch triplet loss = 0.0520
2022-01-13 02:01:31   Extracting database features for evaluation/testing
2022-01-13 02:01:56   Extracting queries features for evaluation/testing
2022-01-13 02:02:15   Calculating recalls
2022-01-13 02:02:16   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 59.4, R@5: 79.7, R@10: 85.7, R@20: 91.0
2022-01-13 02:02:16   Improved: previous best R@5 = 78.1, current R@5 = 79.7
2022-01-13 02:02:16   Start training epoch: 03
2022-01-13 02:02:16   Cache: 0 / 5
2022-01-13 02:03:29   Epoch[03](0/5): current batch triplet loss = 0.0430, average epoch triplet loss = 0.0506
2022-01-13 02:03:29   Cache: 1 / 5
2022-01-13 02:04:42   Epoch[03](1/5): current batch triplet loss = 0.0319, average epoch triplet loss = 0.0496
2022-01-13 02:04:42   Cache: 2 / 5
2022-01-13 02:05:54   Epoch[03](2/5): current batch triplet loss = 0.0743, average epoch triplet loss = 0.0494
2022-01-13 02:05:54   Cache: 3 / 5
2022-01-13 02:07:06   Epoch[03](3/5): current batch triplet loss = 0.0791, average epoch triplet loss = 0.0494
2022-01-13 02:07:06   Cache: 4 / 5
2022-01-13 02:08:18   Epoch[03](4/5): current batch triplet loss = 0.0292, average epoch triplet loss = 0.0487
2022-01-13 02:08:18   Finished epoch 03 in 0:06:01, average epoch triplet loss = 0.0487
2022-01-13 02:08:18   Extracting database features for evaluation/testing
2022-01-13 02:08:43   Extracting queries features for evaluation/testing
2022-01-13 02:09:03   Calculating recalls
2022-01-13 02:09:04   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 60.0, R@5: 79.7, R@10: 85.9, R@20: 90.8
2022-01-13 02:09:04   Improved: previous best R@5 = 79.7, current R@5 = 79.7
2022-01-13 02:09:04   Start training epoch: 04
2022-01-13 02:09:04   Cache: 0 / 5
2022-01-13 02:10:15   Epoch[04](0/5): current batch triplet loss = 0.0408, average epoch triplet loss = 0.0465
2022-01-13 02:10:15   Cache: 1 / 5
2022-01-13 02:11:27   Epoch[04](1/5): current batch triplet loss = 0.0446, average epoch triplet loss = 0.0455
2022-01-13 02:11:27   Cache: 2 / 5
2022-01-13 02:12:39   Epoch[04](2/5): current batch triplet loss = 0.0570, average epoch triplet loss = 0.0454
2022-01-13 02:12:39   Cache: 3 / 5
2022-01-13 02:13:52   Epoch[04](3/5): current batch triplet loss = 0.0448, average epoch triplet loss = 0.0456
2022-01-13 02:13:52   Cache: 4 / 5
2022-01-13 02:15:04   Epoch[04](4/5): current batch triplet loss = 0.0224, average epoch triplet loss = 0.0452
2022-01-13 02:15:04   Finished epoch 04 in 0:05:59, average epoch triplet loss = 0.0452
2022-01-13 02:15:04   Extracting database features for evaluation/testing
2022-01-13 02:15:29   Extracting queries features for evaluation/testing
2022-01-13 02:15:48   Calculating recalls
2022-01-13 02:15:49   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 59.2, R@5: 78.7, R@10: 85.6, R@20: 90.9
2022-01-13 02:15:49   Not improved: 1 / 3: best R@5 = 79.7, current R@5 = 78.7
2022-01-13 02:15:49   Start training epoch: 05
2022-01-13 02:15:49   Cache: 0 / 5
2022-01-13 02:17:02   Epoch[05](0/5): current batch triplet loss = 0.0394, average epoch triplet loss = 0.0426
2022-01-13 02:17:02   Cache: 1 / 5
2022-01-13 02:18:14   Epoch[05](1/5): current batch triplet loss = 0.0321, average epoch triplet loss = 0.0425
2022-01-13 02:18:14   Cache: 2 / 5
2022-01-13 02:19:26   Epoch[05](2/5): current batch triplet loss = 0.0601, average epoch triplet loss = 0.0427
2022-01-13 02:19:26   Cache: 3 / 5
2022-01-13 02:20:38   Epoch[05](3/5): current batch triplet loss = 0.0484, average epoch triplet loss = 0.0425
2022-01-13 02:20:38   Cache: 4 / 5
2022-01-13 02:21:49   Epoch[05](4/5): current batch triplet loss = 0.0173, average epoch triplet loss = 0.0427
2022-01-13 02:21:49   Finished epoch 05 in 0:05:59, average epoch triplet loss = 0.0427
2022-01-13 02:21:49   Extracting database features for evaluation/testing
2022-01-13 02:22:14   Extracting queries features for evaluation/testing
2022-01-13 02:22:33   Calculating recalls
2022-01-13 02:22:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 60.4, R@5: 79.5, R@10: 86.1, R@20: 91.0
2022-01-13 02:22:34   Not improved: 2 / 3: best R@5 = 79.7, current R@5 = 79.5
2022-01-13 02:22:34   Start training epoch: 06
2022-01-13 02:22:34   Cache: 0 / 5
2022-01-13 02:23:46   Epoch[06](0/5): current batch triplet loss = 0.0360, average epoch triplet loss = 0.0413
2022-01-13 02:23:46   Cache: 1 / 5
2022-01-13 02:24:59   Epoch[06](1/5): current batch triplet loss = 0.0637, average epoch triplet loss = 0.0413
2022-01-13 02:24:59   Cache: 2 / 5
2022-01-13 02:26:11   Epoch[06](2/5): current batch triplet loss = 0.0444, average epoch triplet loss = 0.0419
2022-01-13 02:26:11   Cache: 3 / 5
2022-01-13 02:27:23   Epoch[06](3/5): current batch triplet loss = 0.0378, average epoch triplet loss = 0.0415
2022-01-13 02:27:23   Cache: 4 / 5
2022-01-13 02:28:35   Epoch[06](4/5): current batch triplet loss = 0.0349, average epoch triplet loss = 0.0412
2022-01-13 02:28:35   Finished epoch 06 in 0:06:00, average epoch triplet loss = 0.0412
2022-01-13 02:28:35   Extracting database features for evaluation/testing
2022-01-13 02:29:00   Extracting queries features for evaluation/testing
2022-01-13 02:29:20   Calculating recalls
2022-01-13 02:29:21   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 59.9, R@5: 79.5, R@10: 85.6, R@20: 90.6
2022-01-13 02:29:21   Not improved: 3 / 3: best R@5 = 79.7, current R@5 = 79.5
2022-01-13 02:29:21   Performance did not improve for 3 epochs. Stop training.
2022-01-13 02:29:21   Best R@5: 79.7
2022-01-13 02:29:21   Trained for 07 epochs, in total in 0:47:32
2022-01-13 02:29:22   Extracting database features for evaluation/testing
2022-01-13 02:29:47   Extracting queries features for evaluation/testing
2022-01-13 02:30:04   Calculating recalls
2022-01-13 02:30:05   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 59.1, R@5: 79.5, R@10: 85.5, R@20: 90.5
