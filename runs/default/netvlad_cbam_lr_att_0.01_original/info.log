2022-01-20 04:39:02   Arguments: Namespace(upscale_input=False, downscale_input=False, augment_input='None', backbone='resnet18', use_netvlad=True, netvlad_clusters=64, use_gem=None, gem_p=3, gem_eps=1e-06, use_attention='cbam', attention_lr=0.01, use_sgd=None, use_adagrad=None, momentum=0.9, train_batch_size=4, infer_batch_size=16, margin=0.1, epochs_num=20, patience=3, lr=1e-05, cache_refresh_rate=1000, queries_per_epoch=5000, negs_num_per_query=10, neg_samples_num=1000, seed=0, device='cuda', num_workers=8, val_positive_dist_threshold=25, train_positives_dist_threshold=10, recall_values=[1, 5, 10, 20], datasets_folder='./Dataset_pitts30k', exp_name='default', test_dataset_name=None, test_model_path=None, save_attention_mask=None, output_folder='runs/default/2022-01-20_04-39-02')
2022-01-20 04:39:02   The outputs are being saved in runs/default/2022-01-20_04-39-02
2022-01-20 04:39:02   Using 1 GPUs and 12 CPUs
2022-01-20 04:39:03   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-20 04:39:03   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-20 04:39:03   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-20 04:39:03   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-20 04:39:08   Output dimension of the model is 16384
2022-01-20 04:39:08   Start training epoch: 00
2022-01-20 04:53:48   Finished epoch 00 in 0:14:39, average epoch triplet loss = 0.0288
2022-01-20 04:55:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 85.4, R@5: 94.7, R@10: 96.7, R@20: 98.0
2022-01-20 04:55:40   Improved: previous best R@5 = 0.0, current R@5 = 94.7
2022-01-20 04:55:40   Start training epoch: 01
2022-01-20 05:10:19   Finished epoch 01 in 0:14:38, average epoch triplet loss = 0.0238
2022-01-20 05:12:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.8, R@5: 95.7, R@10: 97.3, R@20: 98.4
2022-01-20 05:12:10   Improved: previous best R@5 = 94.7, current R@5 = 95.7
2022-01-20 05:12:10   Start training epoch: 02
2022-01-20 05:26:48   Finished epoch 02 in 0:14:38, average epoch triplet loss = 0.0207
2022-01-20 05:28:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 96.0, R@10: 97.5, R@20: 98.5
2022-01-20 05:28:41   Improved: previous best R@5 = 95.7, current R@5 = 96.0
2022-01-20 05:28:41   Start training epoch: 03
2022-01-20 05:43:19   Finished epoch 03 in 0:14:38, average epoch triplet loss = 0.0193
2022-01-20 05:45:00   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 96.0, R@10: 97.5, R@20: 98.4
2022-01-20 05:45:00   Improved: previous best R@5 = 96.0, current R@5 = 96.0
2022-01-20 05:45:00   Start training epoch: 04
2022-01-20 05:59:41   Finished epoch 04 in 0:14:40, average epoch triplet loss = 0.0184
2022-01-20 06:01:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.4, R@5: 96.0, R@10: 97.6, R@20: 98.4
2022-01-20 06:01:15   Not improved: 1 / 3: best R@5 = 96.0, current R@5 = 96.0
2022-01-20 06:01:15   Start training epoch: 05
2022-01-20 06:15:57   Finished epoch 05 in 0:14:42, average epoch triplet loss = 0.0171
2022-01-20 06:17:44   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.5, R@5: 96.0, R@10: 97.5, R@20: 98.4
2022-01-20 06:17:44   Improved: previous best R@5 = 96.0, current R@5 = 96.0
2022-01-20 06:17:44   Start training epoch: 06
2022-01-20 06:32:25   Finished epoch 06 in 0:14:41, average epoch triplet loss = 0.0172
2022-01-20 06:34:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.6, R@5: 96.0, R@10: 97.6, R@20: 98.4
2022-01-20 06:34:09   Not improved: 1 / 3: best R@5 = 96.0, current R@5 = 96.0
2022-01-20 06:34:09   Start training epoch: 07
2022-01-20 06:48:51   Finished epoch 07 in 0:14:42, average epoch triplet loss = 0.0157
2022-01-20 06:50:38   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.7, R@5: 96.2, R@10: 97.6, R@20: 98.4
2022-01-20 06:50:38   Improved: previous best R@5 = 96.0, current R@5 = 96.2
2022-01-20 06:50:38   Start training epoch: 08
2022-01-20 07:05:18   Finished epoch 08 in 0:14:39, average epoch triplet loss = 0.0157
2022-01-20 07:07:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.4, R@5: 96.4, R@10: 97.6, R@20: 98.5
2022-01-20 07:07:19   Improved: previous best R@5 = 96.2, current R@5 = 96.4
2022-01-20 07:07:19   Start training epoch: 09
2022-01-20 07:22:00   Finished epoch 09 in 0:14:41, average epoch triplet loss = 0.0149
2022-01-20 07:23:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.7, R@5: 96.1, R@10: 97.5, R@20: 98.4
2022-01-20 07:23:56   Not improved: 1 / 3: best R@5 = 96.4, current R@5 = 96.1
2022-01-20 07:23:56   Start training epoch: 10
2022-01-20 07:38:36   Finished epoch 10 in 0:14:39, average epoch triplet loss = 0.0140
2022-01-20 07:40:37   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.5, R@5: 96.2, R@10: 97.5, R@20: 98.4
2022-01-20 07:40:38   Not improved: 2 / 3: best R@5 = 96.4, current R@5 = 96.2
2022-01-20 07:40:38   Start training epoch: 11
2022-01-20 07:55:18   Finished epoch 11 in 0:14:40, average epoch triplet loss = 0.0135
2022-01-20 07:57:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.6, R@5: 96.1, R@10: 97.5, R@20: 98.4
2022-01-20 07:57:09   Not improved: 3 / 3: best R@5 = 96.4, current R@5 = 96.1
2022-01-20 07:57:09   Performance did not improve for 3 epochs. Stop training.
2022-01-20 07:57:09   Best R@5: 96.4
2022-01-20 07:57:09   Trained for 12 epochs, in total in 3:18:06
2022-01-20 07:58:36   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 86.6, R@5: 93.3, R@10: 94.9, R@20: 96.5
