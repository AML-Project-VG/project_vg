2022-01-06 22:10:20   Arguments: Namespace(cache_refresh_rate=1000, datasets_folder='./', device='cuda', epochs_num=10, exp_name='default', infer_batch_size=16, lr=0.01, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=8, output_folder='runs/default/2022-01-06_22-10-20', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, use_netvlad=None, val_positive_dist_threshold=25)
2022-01-06 22:10:20   The outputs are being saved in runs/default/2022-01-06_22-10-20
2022-01-06 22:10:21   Using 1 GPUs and 6 CPUs
2022-01-06 22:10:21   Loading dataset Pitts30k from folder ./
2022-01-06 22:10:23   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-06 22:10:23   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-06 22:10:25   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-06 22:10:26   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-06 22:10:29   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-06 22:10:51   Output dimension of the model is 256
2022-01-06 22:10:51   Start training epoch: 00
2022-01-06 22:10:51   Cache: 0 / 5
2022-01-06 22:18:45   Epoch[00](0/5): current batch triplet loss = 0.0806, average epoch triplet loss = 0.0559
2022-01-06 22:18:46   Cache: 1 / 5
2022-01-06 22:26:41   Epoch[00](1/5): current batch triplet loss = 0.1063, average epoch triplet loss = 0.0556
2022-01-06 22:26:41   Cache: 2 / 5
2022-01-06 22:34:37   Epoch[00](2/5): current batch triplet loss = 0.0394, average epoch triplet loss = 0.0542
2022-01-06 22:34:37   Cache: 3 / 5
2022-01-06 22:42:31   Epoch[00](3/5): current batch triplet loss = 0.0742, average epoch triplet loss = 0.0531
2022-01-06 22:42:32   Cache: 4 / 5
2022-01-06 22:50:27   Epoch[00](4/5): current batch triplet loss = 0.0397, average epoch triplet loss = 0.0522
2022-01-06 22:50:27   Finished epoch 00 in 0:39:36, average epoch triplet loss = 0.0522
2022-01-06 22:50:28   Extracting database features for evaluation/testing
2022-01-06 22:53:14   Extracting queries features for evaluation/testing
2022-01-06 22:55:21   Calculating recalls
2022-01-06 22:55:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 36.3, R@5: 60.7, R@10: 71.1, R@20: 80.6
2022-01-06 22:55:25   Improved: previous best R@5 = 0.0, current R@5 = 60.7
2022-01-06 22:55:25   Start training epoch: 01
2022-01-06 22:55:25   Cache: 0 / 5
2022-01-06 23:03:26   Epoch[01](0/5): current batch triplet loss = 0.0330, average epoch triplet loss = 0.0443
2022-01-06 23:03:26   Cache: 1 / 5
2022-01-06 23:11:22   Epoch[01](1/5): current batch triplet loss = 0.0359, average epoch triplet loss = 0.0447
2022-01-06 23:11:22   Cache: 2 / 5
2022-01-06 23:19:17   Epoch[01](2/5): current batch triplet loss = 0.0308, average epoch triplet loss = 0.0436
2022-01-06 23:19:17   Cache: 3 / 5
2022-01-06 23:27:12   Epoch[01](3/5): current batch triplet loss = 0.0279, average epoch triplet loss = 0.0435
2022-01-06 23:27:12   Cache: 4 / 5
2022-01-06 23:35:08   Epoch[01](4/5): current batch triplet loss = 0.0351, average epoch triplet loss = 0.0430
2022-01-06 23:35:08   Finished epoch 01 in 0:39:43, average epoch triplet loss = 0.0430
2022-01-06 23:35:08   Extracting database features for evaluation/testing
2022-01-06 23:37:54   Extracting queries features for evaluation/testing
2022-01-06 23:40:01   Calculating recalls
2022-01-06 23:40:03   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 36.7, R@5: 59.3, R@10: 70.7, R@20: 80.6
2022-01-06 23:40:03   Not improved: 1 / 3: best R@5 = 60.7, current R@5 = 59.3
2022-01-06 23:40:03   Start training epoch: 02
2022-01-06 23:40:03   Cache: 0 / 5
2022-01-06 23:47:58   Epoch[02](0/5): current batch triplet loss = 0.0602, average epoch triplet loss = 0.0363
2022-01-06 23:47:58   Cache: 1 / 5
2022-01-06 23:55:53   Epoch[02](1/5): current batch triplet loss = 0.0257, average epoch triplet loss = 0.0372
2022-01-06 23:55:53   Cache: 2 / 5
2022-01-07 00:03:48   Epoch[02](2/5): current batch triplet loss = 0.0238, average epoch triplet loss = 0.0374
2022-01-07 00:03:49   Cache: 3 / 5
2022-01-07 00:11:44   Epoch[02](3/5): current batch triplet loss = 0.0322, average epoch triplet loss = 0.0366
2022-01-07 00:11:44   Cache: 4 / 5
2022-01-07 00:19:38   Epoch[02](4/5): current batch triplet loss = 0.0136, average epoch triplet loss = 0.0365
2022-01-07 00:19:38   Finished epoch 02 in 0:39:35, average epoch triplet loss = 0.0365
2022-01-07 00:19:38   Extracting database features for evaluation/testing
2022-01-07 00:22:25   Extracting queries features for evaluation/testing
2022-01-07 00:24:32   Calculating recalls
2022-01-07 00:24:33   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 39.6, R@5: 64.2, R@10: 74.3, R@20: 83.4
2022-01-07 00:24:35   Improved: previous best R@5 = 60.7, current R@5 = 64.2
2022-01-07 00:24:35   Start training epoch: 03
2022-01-07 00:24:35   Cache: 0 / 5
2022-01-07 00:32:30   Epoch[03](0/5): current batch triplet loss = 0.0082, average epoch triplet loss = 0.0311
2022-01-07 00:32:30   Cache: 1 / 5
2022-01-07 00:40:24   Epoch[03](1/5): current batch triplet loss = 0.0272, average epoch triplet loss = 0.0324
2022-01-07 00:40:24   Cache: 2 / 5
2022-01-07 00:48:19   Epoch[03](2/5): current batch triplet loss = 0.0328, average epoch triplet loss = 0.0319
2022-01-07 00:48:19   Cache: 3 / 5
2022-01-07 00:56:13   Epoch[03](3/5): current batch triplet loss = 0.0554, average epoch triplet loss = 0.0319
2022-01-07 00:56:13   Cache: 4 / 5
2022-01-07 01:04:07   Epoch[03](4/5): current batch triplet loss = 0.0380, average epoch triplet loss = 0.0315
2022-01-07 01:04:07   Finished epoch 03 in 0:39:32, average epoch triplet loss = 0.0315
2022-01-07 01:04:07   Extracting database features for evaluation/testing
2022-01-07 01:06:54   Extracting queries features for evaluation/testing
2022-01-07 01:09:01   Calculating recalls
2022-01-07 01:09:02   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 45.8, R@5: 71.6, R@10: 80.8, R@20: 88.0
2022-01-07 01:09:04   Improved: previous best R@5 = 64.2, current R@5 = 71.6
2022-01-07 01:09:04   Start training epoch: 04
2022-01-07 01:09:04   Cache: 0 / 5
2022-01-07 01:16:59   Epoch[04](0/5): current batch triplet loss = 0.0044, average epoch triplet loss = 0.0306
2022-01-07 01:16:59   Cache: 1 / 5
2022-01-07 01:24:53   Epoch[04](1/5): current batch triplet loss = 0.0315, average epoch triplet loss = 0.0290
2022-01-07 01:24:53   Cache: 2 / 5
2022-01-07 01:32:47   Epoch[04](2/5): current batch triplet loss = 0.0743, average epoch triplet loss = 0.0295
2022-01-07 01:32:47   Cache: 3 / 5
2022-01-07 01:40:41   Epoch[04](3/5): current batch triplet loss = 0.0383, average epoch triplet loss = 0.0297
2022-01-07 01:40:42   Cache: 4 / 5
2022-01-07 01:48:35   Epoch[04](4/5): current batch triplet loss = 0.0184, average epoch triplet loss = 0.0294
2022-01-07 01:48:35   Finished epoch 04 in 0:39:30, average epoch triplet loss = 0.0294
2022-01-07 01:48:35   Extracting database features for evaluation/testing
2022-01-07 01:51:21   Extracting queries features for evaluation/testing
2022-01-07 01:53:28   Calculating recalls
2022-01-07 01:53:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 46.6, R@5: 70.5, R@10: 79.1, R@20: 86.3
2022-01-07 01:53:30   Not improved: 1 / 3: best R@5 = 71.6, current R@5 = 70.5
2022-01-07 01:53:30   Start training epoch: 05
2022-01-07 01:53:30   Cache: 0 / 5
2022-01-07 02:01:24   Epoch[05](0/5): current batch triplet loss = 0.0181, average epoch triplet loss = 0.0285
2022-01-07 02:01:24   Cache: 1 / 5
2022-01-07 02:09:18   Epoch[05](1/5): current batch triplet loss = 0.0452, average epoch triplet loss = 0.0269
2022-01-07 02:09:18   Cache: 2 / 5
2022-01-07 02:17:12   Epoch[05](2/5): current batch triplet loss = 0.0160, average epoch triplet loss = 0.0272
2022-01-07 02:17:12   Cache: 3 / 5
2022-01-07 02:25:06   Epoch[05](3/5): current batch triplet loss = 0.0198, average epoch triplet loss = 0.0271
2022-01-07 02:25:06   Cache: 4 / 5
2022-01-07 02:33:00   Epoch[05](4/5): current batch triplet loss = 0.0357, average epoch triplet loss = 0.0268
2022-01-07 02:33:00   Finished epoch 05 in 0:39:30, average epoch triplet loss = 0.0268
2022-01-07 02:33:00   Extracting database features for evaluation/testing
2022-01-07 02:35:47   Extracting queries features for evaluation/testing
2022-01-07 02:37:53   Calculating recalls
2022-01-07 02:37:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 44.9, R@5: 68.3, R@10: 77.9, R@20: 85.9
2022-01-07 02:37:56   Not improved: 2 / 3: best R@5 = 71.6, current R@5 = 68.3
2022-01-07 02:37:56   Start training epoch: 06
2022-01-07 02:37:56   Cache: 0 / 5
2022-01-07 02:45:49   Epoch[06](0/5): current batch triplet loss = 0.0225, average epoch triplet loss = 0.0248
2022-01-07 02:45:49   Cache: 1 / 5
2022-01-07 02:53:42   Epoch[06](1/5): current batch triplet loss = 0.0087, average epoch triplet loss = 0.0244
2022-01-07 02:53:42   Cache: 2 / 5
2022-01-07 03:01:36   Epoch[06](2/5): current batch triplet loss = 0.0114, average epoch triplet loss = 0.0242
2022-01-07 03:01:36   Cache: 3 / 5
2022-01-07 03:09:30   Epoch[06](3/5): current batch triplet loss = 0.0235, average epoch triplet loss = 0.0242
2022-01-07 03:09:30   Cache: 4 / 5
2022-01-07 03:17:24   Epoch[06](4/5): current batch triplet loss = 0.0144, average epoch triplet loss = 0.0241
2022-01-07 03:17:24   Finished epoch 06 in 0:39:28, average epoch triplet loss = 0.0241
2022-01-07 03:17:24   Extracting database features for evaluation/testing
2022-01-07 03:20:11   Extracting queries features for evaluation/testing
2022-01-07 03:22:18   Calculating recalls
2022-01-07 03:22:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 44.3, R@5: 70.0, R@10: 80.2, R@20: 88.2
2022-01-07 03:22:20   Not improved: 3 / 3: best R@5 = 71.6, current R@5 = 70.0
2022-01-07 03:22:20   Performance did not improve for 3 epochs. Stop training.
2022-01-07 03:22:20   Best R@5: 71.6
2022-01-07 03:22:20   Trained for 07 epochs, in total in 5:12:00
2022-01-07 03:22:22   Extracting database features for evaluation/testing
2022-01-07 03:25:08   Extracting queries features for evaluation/testing
2022-01-07 03:27:02   Calculating recalls
2022-01-07 03:27:03   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 45.4, R@5: 72.3, R@10: 81.3, R@20: 88.4
