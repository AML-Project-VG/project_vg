2022-01-05 20:47:18   Arguments: Namespace(use_netvlad=True, netvlad_clusters=64, train_batch_size=4, infer_batch_size=16, margin=0.1, epochs_num=5, patience=3, lr=0.0001, cache_refresh_rate=1000, queries_per_epoch=5000, negs_num_per_query=10, neg_samples_num=1000, seed=0, device='cuda', num_workers=8, val_positive_dist_threshold=25, train_positives_dist_threshold=10, recall_values=[1, 5, 10, 20], datasets_folder='./Data', exp_name='default', output_folder='runs/default/2022-01-05_20-47-18')
2022-01-05 20:47:18   The outputs are being saved in runs/default/2022-01-05_20-47-18
2022-01-05 20:47:18   Using 1 GPUs and 12 CPUs
2022-01-05 20:47:18   Loading dataset Pitts30k from folder ./Data
2022-01-05 20:47:18   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-05 20:47:18   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-05 20:47:18   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-05 20:47:18   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-05 20:47:19   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-05 20:47:21   Output dimension of the model is 16384
2022-01-05 20:47:21   Start training epoch: 00
2022-01-05 20:47:21   Cache: 0 / 5
2022-01-05 20:50:18   Epoch[00](0/5): current batch triplet loss = 0.0918, average epoch triplet loss = 0.0929
2022-01-05 20:50:18   Cache: 1 / 5
2022-01-05 20:53:20   Epoch[00](1/5): current batch triplet loss = 0.0963, average epoch triplet loss = 0.0913
2022-01-05 20:53:20   Cache: 2 / 5
2022-01-05 20:56:20   Epoch[00](2/5): current batch triplet loss = 0.0881, average epoch triplet loss = 0.0895
2022-01-05 20:56:20   Cache: 3 / 5
2022-01-05 20:59:20   Epoch[00](3/5): current batch triplet loss = 0.0927, average epoch triplet loss = 0.0882
2022-01-05 20:59:20   Cache: 4 / 5
2022-01-05 21:02:17   Epoch[00](4/5): current batch triplet loss = 0.0604, average epoch triplet loss = 0.0867
2022-01-05 21:02:17   Finished epoch 00 in 0:14:55, average epoch triplet loss = 0.0867
2022-01-05 21:02:17   Extracting database features for evaluation/testing
2022-01-05 21:02:53   Extracting queries features for evaluation/testing
2022-01-05 21:03:45   Calculating recalls
2022-01-05 21:04:07   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 38.2, R@5: 61.7, R@10: 71.8, R@20: 81.4
2022-01-05 21:04:07   Improved: previous best R@5 = 0.0, current R@5 = 61.7
2022-01-05 21:04:07   Start training epoch: 01
2022-01-05 21:04:07   Cache: 0 / 5
2022-01-05 21:07:00   Epoch[01](0/5): current batch triplet loss = 0.0827, average epoch triplet loss = 0.0782
2022-01-05 21:07:00   Cache: 1 / 5
2022-01-05 21:09:51   Epoch[01](1/5): current batch triplet loss = 0.0626, average epoch triplet loss = 0.0765
2022-01-05 21:09:51   Cache: 2 / 5
2022-01-05 21:12:43   Epoch[01](2/5): current batch triplet loss = 0.0957, average epoch triplet loss = 0.0754
2022-01-05 21:12:43   Cache: 3 / 5
2022-01-05 21:15:36   Epoch[01](3/5): current batch triplet loss = 0.0644, average epoch triplet loss = 0.0735
2022-01-05 21:15:36   Cache: 4 / 5
2022-01-05 21:18:31   Epoch[01](4/5): current batch triplet loss = 0.0663, average epoch triplet loss = 0.0721
2022-01-05 21:18:31   Finished epoch 01 in 0:14:23, average epoch triplet loss = 0.0721
2022-01-05 21:18:31   Extracting database features for evaluation/testing
2022-01-05 21:19:07   Extracting queries features for evaluation/testing
2022-01-05 21:19:47   Calculating recalls
2022-01-05 21:20:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 32.7, R@5: 53.0, R@10: 62.1, R@20: 71.5
2022-01-05 21:20:09   Not improved: 1 / 3: best R@5 = 61.7, current R@5 = 53.0
2022-01-05 21:20:09   Start training epoch: 02
2022-01-05 21:20:09   Cache: 0 / 5
2022-01-05 21:23:01   Epoch[02](0/5): current batch triplet loss = 0.0779, average epoch triplet loss = 0.0612
2022-01-05 21:23:01   Cache: 1 / 5
2022-01-05 21:25:53   Epoch[02](1/5): current batch triplet loss = 0.0430, average epoch triplet loss = 0.0589
2022-01-05 21:25:53   Cache: 2 / 5
2022-01-05 21:28:45   Epoch[02](2/5): current batch triplet loss = 0.0482, average epoch triplet loss = 0.0573
2022-01-05 21:28:45   Cache: 3 / 5
2022-01-05 21:31:37   Epoch[02](3/5): current batch triplet loss = 0.0350, average epoch triplet loss = 0.0551
2022-01-05 21:31:37   Cache: 4 / 5
2022-01-05 21:34:29   Epoch[02](4/5): current batch triplet loss = 0.0144, average epoch triplet loss = 0.0532
2022-01-05 21:34:29   Finished epoch 02 in 0:14:19, average epoch triplet loss = 0.0532
2022-01-05 21:34:29   Extracting database features for evaluation/testing
2022-01-05 21:35:04   Extracting queries features for evaluation/testing
2022-01-05 21:36:02   Calculating recalls
2022-01-05 21:36:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 37.6, R@5: 59.0, R@10: 68.4, R@20: 77.5
2022-01-05 21:36:28   Not improved: 2 / 3: best R@5 = 61.7, current R@5 = 59.0
2022-01-05 21:36:28   Start training epoch: 03
2022-01-05 21:36:28   Cache: 0 / 5
2022-01-05 21:39:20   Epoch[03](0/5): current batch triplet loss = 0.0406, average epoch triplet loss = 0.0413
2022-01-05 21:39:20   Cache: 1 / 5
2022-01-05 21:42:11   Epoch[03](1/5): current batch triplet loss = 0.0446, average epoch triplet loss = 0.0422
2022-01-05 21:42:11   Cache: 2 / 5
2022-01-05 21:45:03   Epoch[03](2/5): current batch triplet loss = 0.0457, average epoch triplet loss = 0.0408
2022-01-05 21:45:03   Cache: 3 / 5
2022-01-05 21:47:55   Epoch[03](3/5): current batch triplet loss = 0.0590, average epoch triplet loss = 0.0392
2022-01-05 21:47:55   Cache: 4 / 5
2022-01-05 21:50:48   Epoch[03](4/5): current batch triplet loss = 0.0390, average epoch triplet loss = 0.0375
2022-01-05 21:50:48   Finished epoch 03 in 0:14:19, average epoch triplet loss = 0.0375
2022-01-05 21:50:48   Extracting database features for evaluation/testing
2022-01-05 21:51:24   Extracting queries features for evaluation/testing
2022-01-05 21:52:34   Calculating recalls
2022-01-05 21:53:06   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 47.3, R@5: 71.1, R@10: 79.5, R@20: 86.4
2022-01-05 21:53:07   Improved: previous best R@5 = 61.7, current R@5 = 71.1
2022-01-05 21:53:07   Start training epoch: 04
2022-01-05 21:53:07   Cache: 0 / 5
2022-01-05 21:56:05   Epoch[04](0/5): current batch triplet loss = 0.0010, average epoch triplet loss = 0.0287
2022-01-05 21:56:05   Cache: 1 / 5
2022-01-05 21:59:05   Epoch[04](1/5): current batch triplet loss = 0.0036, average epoch triplet loss = 0.0265
2022-01-05 21:59:05   Cache: 2 / 5
2022-01-05 22:02:05   Epoch[04](2/5): current batch triplet loss = 0.0367, average epoch triplet loss = 0.0253
2022-01-05 22:02:05   Cache: 3 / 5
2022-01-05 22:05:07   Epoch[04](3/5): current batch triplet loss = 0.0368, average epoch triplet loss = 0.0242
2022-01-05 22:05:07   Cache: 4 / 5
2022-01-05 22:08:03   Epoch[04](4/5): current batch triplet loss = 0.0173, average epoch triplet loss = 0.0231
2022-01-05 22:08:03   Finished epoch 04 in 0:14:56, average epoch triplet loss = 0.0231
2022-01-05 22:08:03   Extracting database features for evaluation/testing
2022-01-05 22:08:39   Extracting queries features for evaluation/testing
2022-01-05 22:09:27   Calculating recalls
2022-01-05 22:09:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 48.9, R@5: 70.3, R@10: 77.9, R@20: 85.8
2022-01-05 22:09:52   Not improved: 1 / 3: best R@5 = 71.1, current R@5 = 70.3
2022-01-05 22:09:52   Best R@5: 71.1
2022-01-05 22:09:52   Trained for 05 epochs, in total in 1:22:34
2022-01-05 22:09:52   Extracting database features for evaluation/testing
2022-01-05 22:10:28   Extracting queries features for evaluation/testing
2022-01-05 22:10:56   Calculating recalls
2022-01-05 22:11:21   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 46.0, R@5: 69.5, R@10: 78.9, R@20: 86.5
