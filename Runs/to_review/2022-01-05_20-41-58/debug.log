2022-01-05 20:41:58   Arguments: Namespace(cache_refresh_rate=1000, datasets_folder='./project_vg/', device='cuda', epochs_num=7, exp_name='default', infer_batch_size=16, lr=0.0001, margin=0.1, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=16, num_workers=8, output_folder='runs/default/2022-01-05_20-41-58', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, train_batch_size=4, train_positives_dist_threshold=10, use_netvlad=True, val_positive_dist_threshold=25)
2022-01-05 20:41:58   The outputs are being saved in runs/default/2022-01-05_20-41-58
2022-01-05 20:41:58   Using 1 GPUs and 6 CPUs
2022-01-05 20:41:58   Loading dataset Pitts30k from folder ./project_vg/
2022-01-05 20:42:02   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-05 20:42:02   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-05 20:42:04   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-05 20:42:05   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-05 20:42:06   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-05 20:42:08   Output dimension of the model is 4096
2022-01-05 20:42:08   Start training epoch: 00
2022-01-05 20:42:08   Cache: 0 / 5
2022-01-05 20:47:15   Epoch[00](0/5): current batch triplet loss = 0.0918, average epoch triplet loss = 0.0929
2022-01-05 20:47:15   Cache: 1 / 5
2022-01-05 20:52:23   Epoch[00](1/5): current batch triplet loss = 0.0965, average epoch triplet loss = 0.0914
2022-01-05 20:52:23   Cache: 2 / 5
2022-01-05 20:57:31   Epoch[00](2/5): current batch triplet loss = 0.0848, average epoch triplet loss = 0.0896
2022-01-05 20:57:31   Cache: 3 / 5
2022-01-05 21:02:37   Epoch[00](3/5): current batch triplet loss = 0.0916, average epoch triplet loss = 0.0883
2022-01-05 21:02:37   Cache: 4 / 5
2022-01-05 21:07:45   Epoch[00](4/5): current batch triplet loss = 0.0650, average epoch triplet loss = 0.0867
2022-01-05 21:07:45   Finished epoch 00 in 0:25:37, average epoch triplet loss = 0.0867
2022-01-05 21:07:45   Extracting database features for evaluation/testing
2022-01-05 21:09:18   Extracting queries features for evaluation/testing
2022-01-05 21:10:30   Calculating recalls
2022-01-05 21:10:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 37.8, R@5: 61.0, R@10: 71.4, R@20: 80.5
2022-01-05 21:10:41   Improved: previous best R@5 = 0.0, current R@5 = 61.0
2022-01-05 21:10:41   Start training epoch: 01
2022-01-05 21:10:41   Cache: 0 / 5
2022-01-05 21:15:49   Epoch[01](0/5): current batch triplet loss = 0.0812, average epoch triplet loss = 0.0781
2022-01-05 21:15:49   Cache: 1 / 5
2022-01-05 21:20:56   Epoch[01](1/5): current batch triplet loss = 0.0657, average epoch triplet loss = 0.0761
2022-01-05 21:20:56   Cache: 2 / 5
2022-01-05 21:26:04   Epoch[01](2/5): current batch triplet loss = 0.0949, average epoch triplet loss = 0.0757
2022-01-05 21:26:04   Cache: 3 / 5
2022-01-05 21:31:12   Epoch[01](3/5): current batch triplet loss = 0.0651, average epoch triplet loss = 0.0740
2022-01-05 21:31:12   Cache: 4 / 5
2022-01-05 21:36:21   Epoch[01](4/5): current batch triplet loss = 0.0620, average epoch triplet loss = 0.0727
2022-01-05 21:36:21   Finished epoch 01 in 0:25:39, average epoch triplet loss = 0.0727
2022-01-05 21:36:21   Extracting database features for evaluation/testing
2022-01-05 21:37:54   Extracting queries features for evaluation/testing
2022-01-05 21:39:05   Calculating recalls
2022-01-05 21:39:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 30.3, R@5: 49.7, R@10: 59.3, R@20: 68.8
2022-01-05 21:39:16   Not improved: 1 / 3: best R@5 = 61.0, current R@5 = 49.7
2022-01-05 21:39:16   Start training epoch: 02
2022-01-05 21:39:16   Cache: 0 / 5
2022-01-05 21:45:41   Epoch[02](0/5): current batch triplet loss = 0.0693, average epoch triplet loss = 0.0621
2022-01-05 21:45:41   Cache: 1 / 5
2022-01-05 21:50:47   Epoch[02](1/5): current batch triplet loss = 0.0400, average epoch triplet loss = 0.0607
2022-01-05 21:50:48   Cache: 2 / 5
2022-01-05 21:55:55   Epoch[02](2/5): current batch triplet loss = 0.0408, average epoch triplet loss = 0.0593
2022-01-05 21:55:55   Cache: 3 / 5
2022-01-05 22:01:03   Epoch[02](3/5): current batch triplet loss = 0.0359, average epoch triplet loss = 0.0573
2022-01-05 22:01:03   Cache: 4 / 5
2022-01-05 22:06:11   Epoch[02](4/5): current batch triplet loss = 0.0327, average epoch triplet loss = 0.0552
2022-01-05 22:06:11   Finished epoch 02 in 0:26:55, average epoch triplet loss = 0.0552
2022-01-05 22:06:11   Extracting database features for evaluation/testing
2022-01-05 22:07:44   Extracting queries features for evaluation/testing
2022-01-05 22:08:56   Calculating recalls
2022-01-05 22:09:06   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 41.2, R@5: 64.7, R@10: 73.4, R@20: 81.9
2022-01-05 22:09:07   Improved: previous best R@5 = 61.0, current R@5 = 64.7
2022-01-05 22:09:07   Start training epoch: 03
2022-01-05 22:09:07   Cache: 0 / 5
2022-01-05 22:14:19   Epoch[03](0/5): current batch triplet loss = 0.0190, average epoch triplet loss = 0.0432
2022-01-05 22:14:19   Cache: 1 / 5
2022-01-05 22:19:26   Epoch[03](1/5): current batch triplet loss = 0.0333, average epoch triplet loss = 0.0422
2022-01-05 22:19:26   Cache: 2 / 5
2022-01-05 22:24:34   Epoch[03](2/5): current batch triplet loss = 0.0485, average epoch triplet loss = 0.0407
2022-01-05 22:24:34   Cache: 3 / 5
2022-01-05 22:29:42   Epoch[03](3/5): current batch triplet loss = 0.0518, average epoch triplet loss = 0.0393
2022-01-05 22:29:42   Cache: 4 / 5
2022-01-05 22:34:49   Epoch[03](4/5): current batch triplet loss = 0.0549, average epoch triplet loss = 0.0372
2022-01-05 22:34:49   Finished epoch 03 in 0:25:42, average epoch triplet loss = 0.0372
2022-01-05 22:34:50   Extracting database features for evaluation/testing
2022-01-05 22:36:23   Extracting queries features for evaluation/testing
2022-01-05 22:37:34   Calculating recalls
2022-01-05 22:37:44   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 49.6, R@5: 71.8, R@10: 80.2, R@20: 86.8
2022-01-05 22:37:45   Improved: previous best R@5 = 64.7, current R@5 = 71.8
2022-01-05 22:37:45   Start training epoch: 04
2022-01-05 22:37:45   Cache: 0 / 5
2022-01-05 22:42:52   Epoch[04](0/5): current batch triplet loss = 0.0033, average epoch triplet loss = 0.0277
2022-01-05 22:42:52   Cache: 1 / 5
2022-01-05 22:48:00   Epoch[04](1/5): current batch triplet loss = 0.0060, average epoch triplet loss = 0.0248
2022-01-05 22:48:00   Cache: 2 / 5
2022-01-05 22:53:08   Epoch[04](2/5): current batch triplet loss = 0.0266, average epoch triplet loss = 0.0241
2022-01-05 22:53:08   Cache: 3 / 5
2022-01-05 22:58:15   Epoch[04](3/5): current batch triplet loss = 0.0255, average epoch triplet loss = 0.0233
2022-01-05 22:58:16   Cache: 4 / 5
2022-01-05 23:03:23   Epoch[04](4/5): current batch triplet loss = 0.0091, average epoch triplet loss = 0.0221
2022-01-05 23:03:23   Finished epoch 04 in 0:25:37, average epoch triplet loss = 0.0221
2022-01-05 23:03:23   Extracting database features for evaluation/testing
2022-01-05 23:04:57   Extracting queries features for evaluation/testing
2022-01-05 23:06:08   Calculating recalls
2022-01-05 23:06:18   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 47.4, R@5: 70.3, R@10: 78.7, R@20: 85.8
2022-01-05 23:06:18   Not improved: 1 / 3: best R@5 = 71.8, current R@5 = 70.3
2022-01-05 23:06:18   Start training epoch: 05
2022-01-05 23:06:18   Cache: 0 / 5
2022-01-05 23:11:27   Epoch[05](0/5): current batch triplet loss = 0.0029, average epoch triplet loss = 0.0144
2022-01-05 23:11:27   Cache: 1 / 5
2022-01-05 23:16:35   Epoch[05](1/5): current batch triplet loss = 0.0026, average epoch triplet loss = 0.0138
2022-01-05 23:16:35   Cache: 2 / 5
2022-01-05 23:21:42   Epoch[05](2/5): current batch triplet loss = 0.0099, average epoch triplet loss = 0.0135
2022-01-05 23:21:42   Cache: 3 / 5
2022-01-05 23:26:49   Epoch[05](3/5): current batch triplet loss = 0.0032, average epoch triplet loss = 0.0134
2022-01-05 23:26:49   Cache: 4 / 5
2022-01-05 23:31:56   Epoch[05](4/5): current batch triplet loss = 0.0131, average epoch triplet loss = 0.0130
2022-01-05 23:31:56   Finished epoch 05 in 0:25:37, average epoch triplet loss = 0.0130
2022-01-05 23:31:56   Extracting database features for evaluation/testing
2022-01-05 23:33:29   Extracting queries features for evaluation/testing
2022-01-05 23:34:40   Calculating recalls
2022-01-05 23:34:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 50.6, R@5: 73.6, R@10: 81.9, R@20: 88.4
2022-01-05 23:34:53   Improved: previous best R@5 = 71.8, current R@5 = 73.6
2022-01-05 23:34:53   Start training epoch: 06
2022-01-05 23:34:53   Cache: 0 / 5
2022-01-05 23:39:59   Epoch[06](0/5): current batch triplet loss = 0.0030, average epoch triplet loss = 0.0120
2022-01-05 23:40:00   Cache: 1 / 5
2022-01-05 23:45:07   Epoch[06](1/5): current batch triplet loss = 0.0052, average epoch triplet loss = 0.0107
2022-01-05 23:45:07   Cache: 2 / 5
2022-01-05 23:50:15   Epoch[06](2/5): current batch triplet loss = 0.0001, average epoch triplet loss = 0.0105
2022-01-05 23:50:15   Cache: 3 / 5
2022-01-05 23:55:22   Epoch[06](3/5): current batch triplet loss = 0.0043, average epoch triplet loss = 0.0105
2022-01-05 23:55:22   Cache: 4 / 5
2022-01-06 00:00:30   Epoch[06](4/5): current batch triplet loss = 0.0026, average epoch triplet loss = 0.0102
2022-01-06 00:00:30   Finished epoch 06 in 0:25:36, average epoch triplet loss = 0.0102
2022-01-06 00:00:30   Extracting database features for evaluation/testing
2022-01-06 00:02:04   Extracting queries features for evaluation/testing
2022-01-06 00:03:15   Calculating recalls
2022-01-06 00:03:25   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 53.2, R@5: 74.9, R@10: 82.6, R@20: 89.2
2022-01-06 00:03:27   Improved: previous best R@5 = 73.6, current R@5 = 74.9
2022-01-06 00:03:27   Best R@5: 74.9
2022-01-06 00:03:27   Trained for 07 epochs, in total in 3:21:29
2022-01-06 00:03:28   Extracting database features for evaluation/testing
2022-01-06 00:05:11   Extracting queries features for evaluation/testing
2022-01-06 00:06:21   Calculating recalls
2022-01-06 00:06:30   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 52.6, R@5: 75.7, R@10: 83.8, R@20: 90.0
