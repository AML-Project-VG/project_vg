2022-01-15 11:21:41   Arguments: Namespace(backbone='resnet18', cache_refresh_rate=1000, datasets_folder='./Dataset_pitts30k', device='cuda', epochs_num=20, exp_name='default', gem_eps=1e-06, gem_p=3, infer_batch_size=16, lr=1e-05, margin=0.1, momentum=0.9, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=8, output_folder='runs/default/2022-01-15_11-21-41', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_dataset_name=None, test_model_path=None, train_batch_size=4, train_positives_dist_threshold=10, use_adagrad=None, use_gem=None, use_netvlad=True, use_sgd=True, val_positive_dist_threshold=25)
2022-01-15 11:21:41   The outputs are being saved in runs/default/2022-01-15_11-21-41
2022-01-15 11:21:41   Using 1 GPUs and 6 CPUs
2022-01-15 11:21:41   Loading dataset Pitts30k from folder ./Dataset_pitts30k
2022-01-15 11:21:42   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-15 11:21:42   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-15 11:21:43   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-15 11:21:44   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-15 11:21:45   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-15 11:21:48   Output dimension of the model is 16384
2022-01-15 11:21:48   Start training epoch: 00
2022-01-15 11:21:48   Cache: 0 / 5
2022-01-15 11:30:19   Epoch[00](0/5): current batch triplet loss = 0.0487, average epoch triplet loss = 0.0462
2022-01-15 11:30:19   Cache: 1 / 5
2022-01-15 11:38:52   Epoch[00](1/5): current batch triplet loss = 0.0843, average epoch triplet loss = 0.0479
2022-01-15 11:38:52   Cache: 2 / 5
2022-01-15 11:47:24   Epoch[00](2/5): current batch triplet loss = 0.0488, average epoch triplet loss = 0.0485
2022-01-15 11:47:24   Cache: 3 / 5
2022-01-15 11:55:55   Epoch[00](3/5): current batch triplet loss = 0.0701, average epoch triplet loss = 0.0490
2022-01-15 11:55:55   Cache: 4 / 5
2022-01-15 12:04:29   Epoch[00](4/5): current batch triplet loss = 0.0881, average epoch triplet loss = 0.0498
2022-01-15 12:04:29   Finished epoch 00 in 0:42:41, average epoch triplet loss = 0.0498
2022-01-15 12:04:29   Extracting database features for evaluation/testing
2022-01-15 12:06:27   Extracting queries features for evaluation/testing
2022-01-15 12:07:58   Calculating recalls
2022-01-15 12:08:34   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 64.1, R@5: 80.8, R@10: 85.6, R@20: 89.8
2022-01-15 12:08:36   Improved: previous best R@5 = 0.0, current R@5 = 80.8
2022-01-15 12:08:36   Start training epoch: 01
2022-01-15 12:08:36   Cache: 0 / 5
2022-01-15 12:17:08   Epoch[01](0/5): current batch triplet loss = 0.0545, average epoch triplet loss = 0.0520
2022-01-15 12:17:08   Cache: 1 / 5
2022-01-15 12:25:42   Epoch[01](1/5): current batch triplet loss = 0.0403, average epoch triplet loss = 0.0519
2022-01-15 12:25:42   Cache: 2 / 5
2022-01-15 12:34:16   Epoch[01](2/5): current batch triplet loss = 0.0689, average epoch triplet loss = 0.0522
2022-01-15 12:34:16   Cache: 3 / 5
2022-01-15 12:42:49   Epoch[01](3/5): current batch triplet loss = 0.0535, average epoch triplet loss = 0.0526
2022-01-15 12:42:49   Cache: 4 / 5
2022-01-15 12:51:23   Epoch[01](4/5): current batch triplet loss = 0.0839, average epoch triplet loss = 0.0532
2022-01-15 12:51:23   Finished epoch 01 in 0:42:47, average epoch triplet loss = 0.0532
2022-01-15 12:51:23   Extracting database features for evaluation/testing
2022-01-15 12:53:21   Extracting queries features for evaluation/testing
2022-01-15 12:54:52   Calculating recalls
2022-01-15 12:55:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 65.1, R@5: 81.4, R@10: 86.2, R@20: 90.4
2022-01-15 12:55:29   Improved: previous best R@5 = 80.8, current R@5 = 81.4
2022-01-15 12:55:30   Start training epoch: 02
2022-01-15 12:55:30   Cache: 0 / 5
2022-01-15 13:04:01   Epoch[02](0/5): current batch triplet loss = 0.0513, average epoch triplet loss = 0.0535
2022-01-15 13:04:01   Cache: 1 / 5
2022-01-15 13:12:35   Epoch[02](1/5): current batch triplet loss = 0.0480, average epoch triplet loss = 0.0547
2022-01-15 13:12:35   Cache: 2 / 5
2022-01-15 13:21:10   Epoch[02](2/5): current batch triplet loss = 0.0376, average epoch triplet loss = 0.0546
2022-01-15 13:21:10   Cache: 3 / 5
2022-01-15 13:29:46   Epoch[02](3/5): current batch triplet loss = 0.0523, average epoch triplet loss = 0.0544
2022-01-15 13:29:46   Cache: 4 / 5
2022-01-15 13:38:22   Epoch[02](4/5): current batch triplet loss = 0.0438, average epoch triplet loss = 0.0550
2022-01-15 13:38:22   Finished epoch 02 in 0:42:52, average epoch triplet loss = 0.0550
2022-01-15 13:38:22   Extracting database features for evaluation/testing
2022-01-15 13:40:21   Extracting queries features for evaluation/testing
2022-01-15 13:41:51   Calculating recalls
2022-01-15 13:42:27   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 66.4, R@5: 82.7, R@10: 87.3, R@20: 91.1
2022-01-15 13:42:28   Improved: previous best R@5 = 81.4, current R@5 = 82.7
2022-01-15 13:42:28   Start training epoch: 03
2022-01-15 13:42:28   Cache: 0 / 5
2022-01-15 13:51:00   Epoch[03](0/5): current batch triplet loss = 0.0375, average epoch triplet loss = 0.0528
2022-01-15 13:51:00   Cache: 1 / 5
2022-01-15 13:59:35   Epoch[03](1/5): current batch triplet loss = 0.0416, average epoch triplet loss = 0.0540
2022-01-15 13:59:35   Cache: 2 / 5
2022-01-15 14:08:09   Epoch[03](2/5): current batch triplet loss = 0.0460, average epoch triplet loss = 0.0551
2022-01-15 14:08:09   Cache: 3 / 5
2022-01-15 14:16:43   Epoch[03](3/5): current batch triplet loss = 0.0864, average epoch triplet loss = 0.0554
2022-01-15 14:16:43   Cache: 4 / 5
2022-01-15 14:25:18   Epoch[03](4/5): current batch triplet loss = 0.0846, average epoch triplet loss = 0.0557
2022-01-15 14:25:18   Finished epoch 03 in 0:42:49, average epoch triplet loss = 0.0557
2022-01-15 14:25:18   Extracting database features for evaluation/testing
2022-01-15 14:27:15   Extracting queries features for evaluation/testing
2022-01-15 14:28:46   Calculating recalls
2022-01-15 14:29:22   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 68.8, R@5: 84.7, R@10: 88.9, R@20: 92.6
2022-01-15 14:29:23   Improved: previous best R@5 = 82.7, current R@5 = 84.7
2022-01-15 14:29:23   Start training epoch: 04
2022-01-15 14:29:23   Cache: 0 / 5
2022-01-15 14:37:56   Epoch[04](0/5): current batch triplet loss = 0.0233, average epoch triplet loss = 0.0565
2022-01-15 14:37:56   Cache: 1 / 5
2022-01-15 14:46:30   Epoch[04](1/5): current batch triplet loss = 0.0281, average epoch triplet loss = 0.0557
2022-01-15 14:46:30   Cache: 2 / 5
2022-01-15 14:55:03   Epoch[04](2/5): current batch triplet loss = 0.0583, average epoch triplet loss = 0.0561
2022-01-15 14:55:03   Cache: 3 / 5
2022-01-15 15:03:38   Epoch[04](3/5): current batch triplet loss = 0.0538, average epoch triplet loss = 0.0566
2022-01-15 15:03:38   Cache: 4 / 5
2022-01-15 15:12:12   Epoch[04](4/5): current batch triplet loss = 0.0662, average epoch triplet loss = 0.0568
2022-01-15 15:12:12   Finished epoch 04 in 0:42:48, average epoch triplet loss = 0.0568
2022-01-15 15:12:12   Extracting database features for evaluation/testing
2022-01-15 15:14:10   Extracting queries features for evaluation/testing
2022-01-15 15:15:41   Calculating recalls
2022-01-15 15:16:17   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 69.1, R@5: 84.6, R@10: 88.9, R@20: 92.3
2022-01-15 15:16:18   Not improved: 1 / 3: best R@5 = 84.7, current R@5 = 84.6
2022-01-15 15:16:18   Start training epoch: 05
2022-01-15 15:16:18   Cache: 0 / 5
2022-01-15 15:24:51   Epoch[05](0/5): current batch triplet loss = 0.0323, average epoch triplet loss = 0.0581
2022-01-15 15:24:51   Cache: 1 / 5
2022-01-15 15:33:28   Epoch[05](1/5): current batch triplet loss = 0.0647, average epoch triplet loss = 0.0568
2022-01-15 15:33:28   Cache: 2 / 5
2022-01-15 15:42:05   Epoch[05](2/5): current batch triplet loss = 0.0374, average epoch triplet loss = 0.0576
2022-01-15 15:42:05   Cache: 3 / 5
2022-01-15 15:50:40   Epoch[05](3/5): current batch triplet loss = 0.0254, average epoch triplet loss = 0.0574
2022-01-15 15:50:40   Cache: 4 / 5
2022-01-15 15:59:14   Epoch[05](4/5): current batch triplet loss = 0.0648, average epoch triplet loss = 0.0574
2022-01-15 15:59:14   Finished epoch 05 in 0:42:55, average epoch triplet loss = 0.0574
2022-01-15 15:59:14   Extracting database features for evaluation/testing
2022-01-15 16:01:12   Extracting queries features for evaluation/testing
2022-01-15 16:02:43   Calculating recalls
2022-01-15 16:03:19   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 69.8, R@5: 85.4, R@10: 89.6, R@20: 93.0
2022-01-15 16:03:20   Improved: previous best R@5 = 84.7, current R@5 = 85.4
2022-01-15 16:03:20   Start training epoch: 06
2022-01-15 16:03:20   Cache: 0 / 5
2022-01-15 16:11:52   Epoch[06](0/5): current batch triplet loss = 0.0746, average epoch triplet loss = 0.0584
2022-01-15 16:11:52   Cache: 1 / 5
2022-01-15 16:20:26   Epoch[06](1/5): current batch triplet loss = 0.0274, average epoch triplet loss = 0.0576
2022-01-15 16:20:27   Cache: 2 / 5
2022-01-15 16:29:01   Epoch[06](2/5): current batch triplet loss = 0.0186, average epoch triplet loss = 0.0568
2022-01-15 16:29:01   Cache: 3 / 5
2022-01-15 16:37:35   Epoch[06](3/5): current batch triplet loss = 0.0785, average epoch triplet loss = 0.0577
2022-01-15 16:37:35   Cache: 4 / 5
2022-01-15 16:46:10   Epoch[06](4/5): current batch triplet loss = 0.0417, average epoch triplet loss = 0.0577
2022-01-15 16:46:10   Finished epoch 06 in 0:42:49, average epoch triplet loss = 0.0577
2022-01-15 16:46:10   Extracting database features for evaluation/testing
2022-01-15 16:48:08   Extracting queries features for evaluation/testing
2022-01-15 16:49:38   Calculating recalls
2022-01-15 16:50:14   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 70.8, R@5: 86.1, R@10: 89.9, R@20: 93.4
2022-01-15 16:50:15   Improved: previous best R@5 = 85.4, current R@5 = 86.1
2022-01-15 16:50:15   Start training epoch: 07
2022-01-15 16:50:15   Cache: 0 / 5
2022-01-15 16:58:47   Epoch[07](0/5): current batch triplet loss = 0.0449, average epoch triplet loss = 0.0603
2022-01-15 16:58:47   Cache: 1 / 5
2022-01-15 17:07:20   Epoch[07](1/5): current batch triplet loss = 0.0300, average epoch triplet loss = 0.0574
2022-01-15 17:07:20   Cache: 2 / 5
2022-01-15 17:15:53   Epoch[07](2/5): current batch triplet loss = 0.1036, average epoch triplet loss = 0.0572
2022-01-15 17:15:53   Cache: 3 / 5
2022-01-15 17:24:27   Epoch[07](3/5): current batch triplet loss = 0.0450, average epoch triplet loss = 0.0578
2022-01-15 17:24:27   Cache: 4 / 5
2022-01-15 17:33:01   Epoch[07](4/5): current batch triplet loss = 0.0587, average epoch triplet loss = 0.0576
2022-01-15 17:33:01   Finished epoch 07 in 0:42:45, average epoch triplet loss = 0.0576
2022-01-15 17:33:01   Extracting database features for evaluation/testing
2022-01-15 17:34:59   Extracting queries features for evaluation/testing
2022-01-15 17:36:31   Calculating recalls
2022-01-15 17:37:06   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 72.2, R@5: 86.8, R@10: 90.7, R@20: 93.8
2022-01-15 17:37:08   Improved: previous best R@5 = 86.1, current R@5 = 86.8
2022-01-15 17:37:08   Start training epoch: 08
2022-01-15 17:37:08   Cache: 0 / 5
2022-01-15 17:45:39   Epoch[08](0/5): current batch triplet loss = 0.0614, average epoch triplet loss = 0.0586
2022-01-15 17:45:39   Cache: 1 / 5
2022-01-15 17:54:13   Epoch[08](1/5): current batch triplet loss = 0.0856, average epoch triplet loss = 0.0583
2022-01-15 17:54:13   Cache: 2 / 5
2022-01-15 18:02:47   Epoch[08](2/5): current batch triplet loss = 0.0222, average epoch triplet loss = 0.0587
2022-01-15 18:02:47   Cache: 3 / 5
2022-01-15 18:11:19   Epoch[08](3/5): current batch triplet loss = 0.0676, average epoch triplet loss = 0.0582
2022-01-15 18:11:20   Cache: 4 / 5
2022-01-15 18:19:53   Epoch[08](4/5): current batch triplet loss = 0.0364, average epoch triplet loss = 0.0581
2022-01-15 18:19:53   Finished epoch 08 in 0:42:45, average epoch triplet loss = 0.0581
2022-01-15 18:19:53   Extracting database features for evaluation/testing
2022-01-15 18:21:51   Extracting queries features for evaluation/testing
2022-01-15 18:23:23   Calculating recalls
2022-01-15 18:23:59   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 73.5, R@5: 87.7, R@10: 91.4, R@20: 94.5
2022-01-15 18:24:00   Improved: previous best R@5 = 86.8, current R@5 = 87.7
2022-01-15 18:24:00   Start training epoch: 09
2022-01-15 18:24:00   Cache: 0 / 5
2022-01-15 18:32:33   Epoch[09](0/5): current batch triplet loss = 0.0687, average epoch triplet loss = 0.0583
2022-01-15 18:32:33   Cache: 1 / 5
2022-01-15 18:41:06   Epoch[09](1/5): current batch triplet loss = 0.0587, average epoch triplet loss = 0.0573
2022-01-15 18:41:06   Cache: 2 / 5
2022-01-15 18:49:39   Epoch[09](2/5): current batch triplet loss = 0.0512, average epoch triplet loss = 0.0578
2022-01-15 18:49:39   Cache: 3 / 5
2022-01-15 18:58:13   Epoch[09](3/5): current batch triplet loss = 0.0602, average epoch triplet loss = 0.0577
2022-01-15 18:58:13   Cache: 4 / 5
2022-01-15 19:06:46   Epoch[09](4/5): current batch triplet loss = 0.0342, average epoch triplet loss = 0.0578
2022-01-15 19:06:46   Finished epoch 09 in 0:42:45, average epoch triplet loss = 0.0578
2022-01-15 19:06:46   Extracting database features for evaluation/testing
2022-01-15 19:08:44   Extracting queries features for evaluation/testing
2022-01-15 19:10:15   Calculating recalls
2022-01-15 19:10:51   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 73.0, R@5: 87.5, R@10: 91.0, R@20: 94.2
2022-01-15 19:10:51   Not improved: 1 / 3: best R@5 = 87.7, current R@5 = 87.5
2022-01-15 19:10:51   Start training epoch: 10
2022-01-15 19:10:51   Cache: 0 / 5
2022-01-15 19:19:22   Epoch[10](0/5): current batch triplet loss = 0.0372, average epoch triplet loss = 0.0571
2022-01-15 19:19:22   Cache: 1 / 5
2022-01-15 19:27:55   Epoch[10](1/5): current batch triplet loss = 0.1061, average epoch triplet loss = 0.0568
2022-01-15 19:27:55   Cache: 2 / 5
2022-01-15 19:36:28   Epoch[10](2/5): current batch triplet loss = 0.1086, average epoch triplet loss = 0.0563
2022-01-15 19:36:28   Cache: 3 / 5
2022-01-15 19:45:02   Epoch[10](3/5): current batch triplet loss = 0.0459, average epoch triplet loss = 0.0563
2022-01-15 19:45:02   Cache: 4 / 5
2022-01-15 19:53:35   Epoch[10](4/5): current batch triplet loss = 0.0343, average epoch triplet loss = 0.0565
2022-01-15 19:53:35   Finished epoch 10 in 0:42:43, average epoch triplet loss = 0.0565
2022-01-15 19:53:35   Extracting database features for evaluation/testing
2022-01-15 19:55:33   Extracting queries features for evaluation/testing
2022-01-15 19:57:03   Calculating recalls
2022-01-15 19:57:39   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.3, R@5: 88.0, R@10: 91.6, R@20: 94.6
2022-01-15 19:57:40   Improved: previous best R@5 = 87.7, current R@5 = 88.0
2022-01-15 19:57:40   Start training epoch: 11
2022-01-15 19:57:40   Cache: 0 / 5
2022-01-15 20:06:11   Epoch[11](0/5): current batch triplet loss = 0.0581, average epoch triplet loss = 0.0547
2022-01-15 20:06:11   Cache: 1 / 5
2022-01-15 20:14:44   Epoch[11](1/5): current batch triplet loss = 0.0612, average epoch triplet loss = 0.0559
2022-01-15 20:14:44   Cache: 2 / 5
2022-01-15 20:23:17   Epoch[11](2/5): current batch triplet loss = 0.0885, average epoch triplet loss = 0.0565
2022-01-15 20:23:17   Cache: 3 / 5
2022-01-15 20:31:50   Epoch[11](3/5): current batch triplet loss = 0.0689, average epoch triplet loss = 0.0567
2022-01-15 20:31:50   Cache: 4 / 5
2022-01-15 20:40:24   Epoch[11](4/5): current batch triplet loss = 0.0500, average epoch triplet loss = 0.0567
2022-01-15 20:40:24   Finished epoch 11 in 0:42:44, average epoch triplet loss = 0.0567
2022-01-15 20:40:24   Extracting database features for evaluation/testing
2022-01-15 20:42:22   Extracting queries features for evaluation/testing
2022-01-15 20:43:53   Calculating recalls
2022-01-15 20:44:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 74.7, R@5: 88.1, R@10: 91.9, R@20: 94.7
2022-01-15 20:44:30   Improved: previous best R@5 = 88.0, current R@5 = 88.1
2022-01-15 20:44:30   Start training epoch: 12
2022-01-15 20:44:30   Cache: 0 / 5
2022-01-15 20:53:01   Epoch[12](0/5): current batch triplet loss = 0.0919, average epoch triplet loss = 0.0552
2022-01-15 20:53:01   Cache: 1 / 5
2022-01-15 21:01:35   Epoch[12](1/5): current batch triplet loss = 0.0624, average epoch triplet loss = 0.0566
2022-01-15 21:01:35   Cache: 2 / 5
2022-01-15 21:10:07   Epoch[12](2/5): current batch triplet loss = 0.0142, average epoch triplet loss = 0.0565
2022-01-15 21:10:07   Cache: 3 / 5
2022-01-15 21:18:39   Epoch[12](3/5): current batch triplet loss = 0.0677, average epoch triplet loss = 0.0575
2022-01-15 21:18:39   Cache: 4 / 5
2022-01-15 21:27:12   Epoch[12](4/5): current batch triplet loss = 0.0803, average epoch triplet loss = 0.0575
2022-01-15 21:27:12   Finished epoch 12 in 0:42:42, average epoch triplet loss = 0.0575
2022-01-15 21:27:12   Extracting database features for evaluation/testing
2022-01-15 21:29:10   Extracting queries features for evaluation/testing
2022-01-15 21:30:40   Calculating recalls
2022-01-15 21:31:16   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 75.9, R@5: 88.9, R@10: 92.3, R@20: 95.1
2022-01-15 21:31:17   Improved: previous best R@5 = 88.1, current R@5 = 88.9
2022-01-15 21:31:17   Start training epoch: 13
2022-01-15 21:31:17   Cache: 0 / 5
2022-01-15 21:39:48   Epoch[13](0/5): current batch triplet loss = 0.0805, average epoch triplet loss = 0.0585
2022-01-15 21:39:48   Cache: 1 / 5
2022-01-15 21:48:21   Epoch[13](1/5): current batch triplet loss = 0.0418, average epoch triplet loss = 0.0583
2022-01-15 21:48:21   Cache: 2 / 5
2022-01-15 21:56:54   Epoch[13](2/5): current batch triplet loss = 0.0563, average epoch triplet loss = 0.0577
2022-01-15 21:56:54   Cache: 3 / 5
2022-01-15 22:05:28   Epoch[13](3/5): current batch triplet loss = 0.0767, average epoch triplet loss = 0.0574
2022-01-15 22:05:28   Cache: 4 / 5
2022-01-15 22:14:00   Epoch[13](4/5): current batch triplet loss = 0.0637, average epoch triplet loss = 0.0572
2022-01-15 22:14:00   Finished epoch 13 in 0:42:43, average epoch triplet loss = 0.0572
2022-01-15 22:14:00   Extracting database features for evaluation/testing
2022-01-15 22:15:58   Extracting queries features for evaluation/testing
2022-01-15 22:17:29   Calculating recalls
2022-01-15 22:18:04   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 75.6, R@5: 88.8, R@10: 92.4, R@20: 95.3
2022-01-15 22:18:05   Not improved: 1 / 3: best R@5 = 88.9, current R@5 = 88.8
2022-01-15 22:18:05   Start training epoch: 14
2022-01-15 22:18:05   Cache: 0 / 5
2022-01-15 22:26:36   Epoch[14](0/5): current batch triplet loss = 0.0244, average epoch triplet loss = 0.0598
2022-01-15 22:26:36   Cache: 1 / 5
2022-01-15 22:35:09   Epoch[14](1/5): current batch triplet loss = 0.0879, average epoch triplet loss = 0.0585
2022-01-15 22:35:09   Cache: 2 / 5
2022-01-15 22:43:41   Epoch[14](2/5): current batch triplet loss = 0.0528, average epoch triplet loss = 0.0582
2022-01-15 22:43:41   Cache: 3 / 5
2022-01-15 22:52:13   Epoch[14](3/5): current batch triplet loss = 0.0696, average epoch triplet loss = 0.0580
2022-01-15 22:52:13   Cache: 4 / 5
2022-01-15 23:00:46   Epoch[14](4/5): current batch triplet loss = 0.0852, average epoch triplet loss = 0.0579
2022-01-15 23:00:46   Finished epoch 14 in 0:42:40, average epoch triplet loss = 0.0579
2022-01-15 23:00:46   Extracting database features for evaluation/testing
2022-01-15 23:02:44   Extracting queries features for evaluation/testing
2022-01-15 23:04:15   Calculating recalls
2022-01-15 23:04:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.4, R@5: 89.5, R@10: 92.7, R@20: 95.4
2022-01-15 23:04:51   Improved: previous best R@5 = 88.9, current R@5 = 89.5
2022-01-15 23:04:51   Start training epoch: 15
2022-01-15 23:04:51   Cache: 0 / 5
2022-01-15 23:13:22   Epoch[15](0/5): current batch triplet loss = 0.0499, average epoch triplet loss = 0.0568
2022-01-15 23:13:22   Cache: 1 / 5
2022-01-15 23:21:56   Epoch[15](1/5): current batch triplet loss = 0.0592, average epoch triplet loss = 0.0558
2022-01-15 23:21:56   Cache: 2 / 5
2022-01-15 23:30:29   Epoch[15](2/5): current batch triplet loss = 0.0307, average epoch triplet loss = 0.0560
2022-01-15 23:30:29   Cache: 3 / 5
2022-01-15 23:39:02   Epoch[15](3/5): current batch triplet loss = 0.0644, average epoch triplet loss = 0.0563
2022-01-15 23:39:02   Cache: 4 / 5
2022-01-15 23:47:37   Epoch[15](4/5): current batch triplet loss = 0.0745, average epoch triplet loss = 0.0565
2022-01-15 23:47:37   Finished epoch 15 in 0:42:45, average epoch triplet loss = 0.0565
2022-01-15 23:47:37   Extracting database features for evaluation/testing
2022-01-15 23:49:35   Extracting queries features for evaluation/testing
2022-01-15 23:51:05   Calculating recalls
2022-01-15 23:51:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.4, R@5: 89.9, R@10: 93.2, R@20: 95.6
2022-01-15 23:51:41   Improved: previous best R@5 = 89.5, current R@5 = 89.9
2022-01-15 23:51:41   Start training epoch: 16
2022-01-15 23:51:41   Cache: 0 / 5
2022-01-16 00:00:13   Epoch[16](0/5): current batch triplet loss = 0.0662, average epoch triplet loss = 0.0566
2022-01-16 00:00:13   Cache: 1 / 5
2022-01-16 00:08:55   Epoch[16](1/5): current batch triplet loss = 0.0491, average epoch triplet loss = 0.0564
2022-01-16 00:08:55   Cache: 2 / 5
2022-01-16 00:17:41   Epoch[16](2/5): current batch triplet loss = 0.0173, average epoch triplet loss = 0.0564
2022-01-16 00:17:41   Cache: 3 / 5
2022-01-16 00:28:09   Epoch[16](3/5): current batch triplet loss = 0.0395, average epoch triplet loss = 0.0570
2022-01-16 00:28:09   Cache: 4 / 5
2022-01-16 00:37:50   Epoch[16](4/5): current batch triplet loss = 0.0629, average epoch triplet loss = 0.0572
2022-01-16 00:37:50   Finished epoch 16 in 0:46:08, average epoch triplet loss = 0.0572
2022-01-16 00:37:51   Extracting database features for evaluation/testing
2022-01-16 00:40:50   Extracting queries features for evaluation/testing
2022-01-16 00:42:22   Calculating recalls
2022-01-16 00:42:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.2, R@5: 89.9, R@10: 93.0, R@20: 95.8
2022-01-16 00:42:58   Not improved: 1 / 3: best R@5 = 89.9, current R@5 = 89.9
2022-01-16 00:42:58   Start training epoch: 17
2022-01-16 00:42:58   Cache: 0 / 5
2022-01-16 00:51:36   Epoch[17](0/5): current batch triplet loss = 0.0425, average epoch triplet loss = 0.0565
2022-01-16 00:51:36   Cache: 1 / 5
2022-01-16 01:00:31   Epoch[17](1/5): current batch triplet loss = 0.0343, average epoch triplet loss = 0.0566
2022-01-16 01:00:31   Cache: 2 / 5
2022-01-16 01:09:13   Epoch[17](2/5): current batch triplet loss = 0.0926, average epoch triplet loss = 0.0570
2022-01-16 01:09:13   Cache: 3 / 5
2022-01-16 01:17:50   Epoch[17](3/5): current batch triplet loss = 0.0693, average epoch triplet loss = 0.0569
2022-01-16 01:17:50   Cache: 4 / 5
2022-01-16 01:27:10   Epoch[17](4/5): current batch triplet loss = 0.0690, average epoch triplet loss = 0.0571
2022-01-16 01:27:10   Finished epoch 17 in 0:44:12, average epoch triplet loss = 0.0571
2022-01-16 01:27:10   Extracting database features for evaluation/testing
2022-01-16 01:29:08   Extracting queries features for evaluation/testing
2022-01-16 01:30:44   Calculating recalls
2022-01-16 01:31:20   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 77.5, R@5: 90.0, R@10: 93.2, R@20: 95.6
2022-01-16 01:31:21   Improved: previous best R@5 = 89.9, current R@5 = 90.0
2022-01-16 01:31:21   Start training epoch: 18
2022-01-16 01:31:21   Cache: 0 / 5
2022-01-16 01:40:37   Epoch[18](0/5): current batch triplet loss = 0.0405, average epoch triplet loss = 0.0560
2022-01-16 01:40:37   Cache: 1 / 5
2022-01-16 01:49:17   Epoch[18](1/5): current batch triplet loss = 0.0611, average epoch triplet loss = 0.0572
2022-01-16 01:49:17   Cache: 2 / 5
2022-01-16 01:57:54   Epoch[18](2/5): current batch triplet loss = 0.0684, average epoch triplet loss = 0.0560
2022-01-16 01:57:54   Cache: 3 / 5
2022-01-16 02:07:09   Epoch[18](3/5): current batch triplet loss = 0.0399, average epoch triplet loss = 0.0557
2022-01-16 02:07:09   Cache: 4 / 5
2022-01-16 02:16:31   Epoch[18](4/5): current batch triplet loss = 0.0317, average epoch triplet loss = 0.0559
2022-01-16 02:16:31   Finished epoch 18 in 0:45:10, average epoch triplet loss = 0.0559
2022-01-16 02:16:32   Extracting database features for evaluation/testing
2022-01-16 02:18:45   Extracting queries features for evaluation/testing
2022-01-16 02:20:20   Calculating recalls
2022-01-16 02:20:56   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.0, R@5: 90.4, R@10: 93.6, R@20: 95.8
2022-01-16 02:20:59   Improved: previous best R@5 = 90.0, current R@5 = 90.4
2022-01-16 02:20:59   Start training epoch: 19
2022-01-16 02:20:59   Cache: 0 / 5
2022-01-16 02:29:43   Epoch[19](0/5): current batch triplet loss = 0.0496, average epoch triplet loss = 0.0574
2022-01-16 02:29:43   Cache: 1 / 5
2022-01-16 02:38:31   Epoch[19](1/5): current batch triplet loss = 0.0255, average epoch triplet loss = 0.0571
2022-01-16 02:38:31   Cache: 2 / 5
2022-01-16 02:47:49   Epoch[19](2/5): current batch triplet loss = 0.0637, average epoch triplet loss = 0.0573
2022-01-16 02:47:49   Cache: 3 / 5
2022-01-16 02:56:37   Epoch[19](3/5): current batch triplet loss = 0.0478, average epoch triplet loss = 0.0572
2022-01-16 02:56:38   Cache: 4 / 5
2022-01-16 03:05:37   Epoch[19](4/5): current batch triplet loss = 0.0288, average epoch triplet loss = 0.0572
2022-01-16 03:05:37   Finished epoch 19 in 0:44:37, average epoch triplet loss = 0.0572
2022-01-16 03:05:37   Extracting database features for evaluation/testing
2022-01-16 03:07:36   Extracting queries features for evaluation/testing
2022-01-16 03:09:09   Calculating recalls
2022-01-16 03:09:45   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 78.1, R@5: 90.6, R@10: 93.4, R@20: 95.9
2022-01-16 03:09:47   Improved: previous best R@5 = 90.4, current R@5 = 90.6
2022-01-16 03:09:47   Best R@5: 90.6
2022-01-16 03:09:47   Trained for 20 epochs, in total in 15:48:05
2022-01-16 03:09:47   Extracting database features for evaluation/testing
2022-01-16 03:11:53   Extracting queries features for evaluation/testing
2022-01-16 03:13:14   Calculating recalls
2022-01-16 03:13:46   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 79.7, R@5: 90.1, R@10: 92.9, R@20: 95.0
