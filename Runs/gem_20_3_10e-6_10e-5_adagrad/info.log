2022-01-16 09:25:30   Arguments: Namespace(upscale_input=False, downscale_input=False, augment_input='None', backbone='resnet18', use_netvlad=None, netvlad_clusters=64, use_gem=True, gem_p=3, gem_eps=1e-06, use_sgd=None, use_adagrad=True, momentum=0.9, train_batch_size=4, infer_batch_size=16, margin=0.1, epochs_num=20, patience=3, lr=1e-05, cache_refresh_rate=1000, queries_per_epoch=5000, negs_num_per_query=10, neg_samples_num=1000, seed=0, device='cuda', num_workers=8, val_positive_dist_threshold=25, train_positives_dist_threshold=10, recall_values=[1, 5, 10, 20], datasets_folder='./Dataset_pitts30k', exp_name='default', test_dataset_name=None, test_model_path=None, output_folder='runs/default/2022-01-16_09-25-30')
2022-01-16 09:25:30   The outputs are being saved in runs/default/2022-01-16_09-25-30
2022-01-16 09:25:30   Using 1 GPUs and 12 CPUs
2022-01-16 09:25:30   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-16 09:25:30   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-16 09:25:31   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-16 09:25:31   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-16 09:25:36   Output dimension of the model is 256
2022-01-16 09:25:36   Start training epoch: 00
2022-01-16 09:31:43   Finished epoch 00 in 0:06:07, average epoch triplet loss = 0.0811
2022-01-16 09:32:29   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 38.4, R@5: 59.0, R@10: 68.0, R@20: 76.1
2022-01-16 09:32:29   Improved: previous best R@5 = 0.0, current R@5 = 59.0
2022-01-16 09:32:29   Start training epoch: 01
2022-01-16 09:38:37   Finished epoch 01 in 0:06:07, average epoch triplet loss = 0.0815
2022-01-16 09:39:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 41.1, R@5: 62.1, R@10: 70.6, R@20: 78.7
2022-01-16 09:39:24   Improved: previous best R@5 = 59.0, current R@5 = 62.1
2022-01-16 09:39:24   Start training epoch: 02
2022-01-16 09:45:30   Finished epoch 02 in 0:06:06, average epoch triplet loss = 0.0820
2022-01-16 09:46:17   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 43.7, R@5: 64.5, R@10: 73.0, R@20: 80.9
2022-01-16 09:46:17   Improved: previous best R@5 = 62.1, current R@5 = 64.5
2022-01-16 09:46:17   Start training epoch: 03
2022-01-16 09:52:25   Finished epoch 03 in 0:06:07, average epoch triplet loss = 0.0828
2022-01-16 09:53:11   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 46.3, R@5: 66.5, R@10: 75.0, R@20: 83.1
2022-01-16 09:53:11   Improved: previous best R@5 = 64.5, current R@5 = 66.5
2022-01-16 09:53:11   Start training epoch: 04
2022-01-16 09:59:19   Finished epoch 04 in 0:06:08, average epoch triplet loss = 0.0831
2022-01-16 10:00:05   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 46.8, R@5: 67.6, R@10: 76.1, R@20: 84.0
2022-01-16 10:00:06   Improved: previous best R@5 = 66.5, current R@5 = 67.6
2022-01-16 10:00:06   Start training epoch: 05
2022-01-16 10:06:15   Finished epoch 05 in 0:06:08, average epoch triplet loss = 0.0834
2022-01-16 10:07:01   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 48.7, R@5: 69.4, R@10: 77.7, R@20: 85.0
2022-01-16 10:07:01   Improved: previous best R@5 = 67.6, current R@5 = 69.4
2022-01-16 10:07:01   Start training epoch: 06
2022-01-16 10:13:09   Finished epoch 06 in 0:06:07, average epoch triplet loss = 0.0833
2022-01-16 10:13:55   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 50.2, R@5: 70.8, R@10: 78.8, R@20: 86.1
2022-01-16 10:13:55   Improved: previous best R@5 = 69.4, current R@5 = 70.8
2022-01-16 10:13:55   Start training epoch: 07
2022-01-16 10:20:13   Finished epoch 07 in 0:06:17, average epoch triplet loss = 0.0838
2022-01-16 10:21:00   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 50.7, R@5: 71.3, R@10: 79.5, R@20: 86.5
2022-01-16 10:21:00   Improved: previous best R@5 = 70.8, current R@5 = 71.3
2022-01-16 10:21:00   Start training epoch: 08
2022-01-16 10:27:12   Finished epoch 08 in 0:06:12, average epoch triplet loss = 0.0837
2022-01-16 10:27:58   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 51.0, R@5: 72.2, R@10: 80.4, R@20: 87.1
2022-01-16 10:27:59   Improved: previous best R@5 = 71.3, current R@5 = 72.2
2022-01-16 10:27:59   Start training epoch: 09
2022-01-16 10:34:17   Finished epoch 09 in 0:06:18, average epoch triplet loss = 0.0840
2022-01-16 10:35:05   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 51.4, R@5: 72.2, R@10: 80.4, R@20: 87.0
2022-01-16 10:35:05   Improved: previous best R@5 = 72.2, current R@5 = 72.2
2022-01-16 10:35:05   Start training epoch: 10
2022-01-16 10:41:36   Finished epoch 10 in 0:06:30, average epoch triplet loss = 0.0831
2022-01-16 10:42:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 52.1, R@5: 72.9, R@10: 81.0, R@20: 87.6
2022-01-16 10:42:23   Improved: previous best R@5 = 72.2, current R@5 = 72.9
2022-01-16 10:42:23   Start training epoch: 11
2022-01-16 10:48:52   Finished epoch 11 in 0:06:28, average epoch triplet loss = 0.0836
2022-01-16 10:49:44   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 53.8, R@5: 74.5, R@10: 81.9, R@20: 88.6
2022-01-16 10:49:44   Improved: previous best R@5 = 72.9, current R@5 = 74.5
2022-01-16 10:49:44   Start training epoch: 12
2022-01-16 10:56:25   Finished epoch 12 in 0:06:40, average epoch triplet loss = 0.0845
2022-01-16 10:57:13   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 54.0, R@5: 74.6, R@10: 82.2, R@20: 88.4
2022-01-16 10:57:14   Improved: previous best R@5 = 74.5, current R@5 = 74.6
2022-01-16 10:57:14   Start training epoch: 13
2022-01-16 11:03:53   Finished epoch 13 in 0:06:39, average epoch triplet loss = 0.0844
2022-01-16 11:04:41   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 54.3, R@5: 75.0, R@10: 82.5, R@20: 88.7
2022-01-16 11:04:41   Improved: previous best R@5 = 74.6, current R@5 = 75.0
2022-01-16 11:04:41   Start training epoch: 14
2022-01-16 11:11:09   Finished epoch 14 in 0:06:27, average epoch triplet loss = 0.0850
2022-01-16 11:11:57   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 55.5, R@5: 76.1, R@10: 83.1, R@20: 89.3
2022-01-16 11:11:58   Improved: previous best R@5 = 75.0, current R@5 = 76.1
2022-01-16 11:11:58   Start training epoch: 15
2022-01-16 11:19:22   Finished epoch 15 in 0:07:23, average epoch triplet loss = 0.0837
2022-01-16 11:20:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 55.6, R@5: 76.4, R@10: 83.5, R@20: 89.5
2022-01-16 11:20:24   Improved: previous best R@5 = 76.1, current R@5 = 76.4
2022-01-16 11:20:24   Start training epoch: 16
2022-01-16 11:28:41   Finished epoch 16 in 0:08:17, average epoch triplet loss = 0.0846
2022-01-16 11:29:41   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 55.6, R@5: 76.4, R@10: 83.7, R@20: 89.5
2022-01-16 11:29:41   Not improved: 1 / 3: best R@5 = 76.4, current R@5 = 76.4
2022-01-16 11:29:41   Start training epoch: 17
2022-01-16 11:37:33   Finished epoch 17 in 0:07:52, average epoch triplet loss = 0.0844
2022-01-16 11:38:33   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.8, R@5: 77.3, R@10: 84.0, R@20: 89.9
2022-01-16 11:38:33   Improved: previous best R@5 = 76.4, current R@5 = 77.3
2022-01-16 11:38:33   Start training epoch: 18
2022-01-16 11:46:04   Finished epoch 18 in 0:07:31, average epoch triplet loss = 0.0839
2022-01-16 11:46:54   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 57.5, R@5: 78.0, R@10: 84.7, R@20: 90.3
2022-01-16 11:46:55   Improved: previous best R@5 = 77.3, current R@5 = 78.0
2022-01-16 11:46:55   Start training epoch: 19
2022-01-16 11:53:47   Finished epoch 19 in 0:06:51, average epoch triplet loss = 0.0842
2022-01-16 11:54:45   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 56.6, R@5: 77.1, R@10: 84.4, R@20: 90.2
2022-01-16 11:54:45   Not improved: 1 / 3: best R@5 = 78.0, current R@5 = 77.1
2022-01-16 11:54:45   Best R@5: 78.0
2022-01-16 11:54:45   Trained for 20 epochs, in total in 2:29:14
2022-01-16 11:55:40   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 60.9, R@5: 80.4, R@10: 86.9, R@20: 91.5
