2022-01-16 15:36:48   Arguments: Namespace(augment_input='None', backbone='resnet18', cache_refresh_rate=1000, datasets_folder='./Dataset_pitts30k', device='cuda', downscale_input=False, epochs_num=20, exp_name='default', gem_eps=1e-06, gem_p=3, infer_batch_size=16, lr=1e-05, margin=0.1, momentum=0.9, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=12, output_folder='runs/default/2022-01-16_15-36-48', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], seed=0, test_dataset_name=None, test_model_path=None, train_batch_size=4, train_positives_dist_threshold=10, upscale_input=True, use_adagrad=None, use_gem=None, use_netvlad=True, use_sgd=None, val_positive_dist_threshold=25)
2022-01-16 15:36:48   The outputs are being saved in runs/default/2022-01-16_15-36-48
2022-01-16 15:36:48   Using 1 GPUs and 6 CPUs
2022-01-16 15:36:48   Loading dataset Pitts30k from folder ./Dataset_pitts30k
2022-01-16 15:36:50   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-16 15:36:50   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-16 15:36:51   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-16 15:36:52   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-16 15:36:52   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-16 15:36:56   Output dimension of the model is 16384
2022-01-16 15:36:56   Start training epoch: 00
2022-01-16 15:36:56   Cache: 0 / 5
2022-01-16 15:49:39   Epoch[00](0/5): current batch triplet loss = 0.0392, average epoch triplet loss = 0.0407
2022-01-16 15:49:39   Cache: 1 / 5
2022-01-16 16:02:26   Epoch[00](1/5): current batch triplet loss = 0.0416, average epoch triplet loss = 0.0374
2022-01-16 16:02:26   Cache: 2 / 5
2022-01-16 16:15:12   Epoch[00](2/5): current batch triplet loss = 0.0090, average epoch triplet loss = 0.0348
2022-01-16 16:15:12   Cache: 3 / 5
2022-01-16 16:28:01   Epoch[00](3/5): current batch triplet loss = 0.0436, average epoch triplet loss = 0.0331
2022-01-16 16:28:01   Cache: 4 / 5
2022-01-16 16:40:48   Epoch[00](4/5): current batch triplet loss = 0.0390, average epoch triplet loss = 0.0321
2022-01-16 16:40:48   Finished epoch 00 in 1:03:51, average epoch triplet loss = 0.0321
2022-01-16 16:40:48   Extracting database features for evaluation/testing
2022-01-16 16:43:54   Extracting queries features for evaluation/testing
2022-01-16 16:46:17   Calculating recalls
2022-01-16 16:46:53   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 85.1, R@5: 94.4, R@10: 96.4, R@20: 97.8
2022-01-16 16:46:55   Improved: previous best R@5 = 0.0, current R@5 = 94.4
2022-01-16 16:46:55   Start training epoch: 01
2022-01-16 16:46:55   Cache: 0 / 5
2022-01-16 16:59:41   Epoch[01](0/5): current batch triplet loss = 0.0473, average epoch triplet loss = 0.0254
2022-01-16 16:59:41   Cache: 1 / 5
2022-01-16 17:12:29   Epoch[01](1/5): current batch triplet loss = 0.0273, average epoch triplet loss = 0.0253
2022-01-16 17:12:29   Cache: 2 / 5
2022-01-16 17:25:16   Epoch[01](2/5): current batch triplet loss = 0.0240, average epoch triplet loss = 0.0247
2022-01-16 17:25:16   Cache: 3 / 5
2022-01-16 17:38:01   Epoch[01](3/5): current batch triplet loss = 0.0273, average epoch triplet loss = 0.0247
2022-01-16 17:38:01   Cache: 4 / 5
2022-01-16 17:50:46   Epoch[01](4/5): current batch triplet loss = 0.0693, average epoch triplet loss = 0.0246
2022-01-16 17:50:46   Finished epoch 01 in 1:03:51, average epoch triplet loss = 0.0246
2022-01-16 17:50:46   Extracting database features for evaluation/testing
2022-01-16 17:53:52   Extracting queries features for evaluation/testing
2022-01-16 17:56:15   Calculating recalls
2022-01-16 17:56:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.9, R@5: 95.3, R@10: 97.2, R@20: 98.2
2022-01-16 17:56:53   Improved: previous best R@5 = 94.4, current R@5 = 95.3
2022-01-16 17:56:53   Start training epoch: 02
2022-01-16 17:56:53   Cache: 0 / 5
2022-01-16 18:09:41   Epoch[02](0/5): current batch triplet loss = 0.0103, average epoch triplet loss = 0.0225
2022-01-16 18:09:41   Cache: 1 / 5
2022-01-16 18:22:31   Epoch[02](1/5): current batch triplet loss = 0.0117, average epoch triplet loss = 0.0226
2022-01-16 18:22:31   Cache: 2 / 5
2022-01-16 18:35:21   Epoch[02](2/5): current batch triplet loss = 0.0045, average epoch triplet loss = 0.0221
2022-01-16 18:35:21   Cache: 3 / 5
2022-01-16 18:48:12   Epoch[02](3/5): current batch triplet loss = 0.0184, average epoch triplet loss = 0.0218
2022-01-16 18:48:12   Cache: 4 / 5
2022-01-16 19:01:01   Epoch[02](4/5): current batch triplet loss = 0.0085, average epoch triplet loss = 0.0216
2022-01-16 19:01:01   Finished epoch 02 in 1:04:07, average epoch triplet loss = 0.0216
2022-01-16 19:01:01   Extracting database features for evaluation/testing
2022-01-16 19:04:06   Extracting queries features for evaluation/testing
2022-01-16 19:06:29   Calculating recalls
2022-01-16 19:07:05   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.6, R@5: 95.7, R@10: 97.3, R@20: 98.3
2022-01-16 19:07:06   Improved: previous best R@5 = 95.3, current R@5 = 95.7
2022-01-16 19:07:06   Start training epoch: 03
2022-01-16 19:07:06   Cache: 0 / 5
2022-01-16 19:19:49   Epoch[03](0/5): current batch triplet loss = 0.0070, average epoch triplet loss = 0.0188
2022-01-16 19:19:49   Cache: 1 / 5
2022-01-16 19:32:32   Epoch[03](1/5): current batch triplet loss = 0.0277, average epoch triplet loss = 0.0199
2022-01-16 19:32:32   Cache: 2 / 5
2022-01-16 19:45:16   Epoch[03](2/5): current batch triplet loss = 0.0223, average epoch triplet loss = 0.0204
2022-01-16 19:45:16   Cache: 3 / 5
2022-01-16 19:58:01   Epoch[03](3/5): current batch triplet loss = 0.0653, average epoch triplet loss = 0.0202
2022-01-16 19:58:01   Cache: 4 / 5
2022-01-16 20:10:45   Epoch[03](4/5): current batch triplet loss = 0.0225, average epoch triplet loss = 0.0204
2022-01-16 20:10:45   Finished epoch 03 in 1:03:39, average epoch triplet loss = 0.0204
2022-01-16 20:10:45   Extracting database features for evaluation/testing
2022-01-16 20:13:50   Extracting queries features for evaluation/testing
2022-01-16 20:16:12   Calculating recalls
2022-01-16 20:16:48   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.9, R@5: 95.9, R@10: 97.5, R@20: 98.4
2022-01-16 20:16:50   Improved: previous best R@5 = 95.7, current R@5 = 95.9
2022-01-16 20:16:50   Start training epoch: 04
2022-01-16 20:16:50   Cache: 0 / 5
2022-01-16 20:29:33   Epoch[04](0/5): current batch triplet loss = 0.0013, average epoch triplet loss = 0.0191
2022-01-16 20:29:33   Cache: 1 / 5
2022-01-16 20:42:16   Epoch[04](1/5): current batch triplet loss = 0.0119, average epoch triplet loss = 0.0186
2022-01-16 20:42:16   Cache: 2 / 5
2022-01-16 20:55:01   Epoch[04](2/5): current batch triplet loss = 0.0243, average epoch triplet loss = 0.0185
2022-01-16 20:55:01   Cache: 3 / 5
2022-01-16 21:07:44   Epoch[04](3/5): current batch triplet loss = 0.0218, average epoch triplet loss = 0.0191
2022-01-16 21:07:44   Cache: 4 / 5
2022-01-16 21:20:29   Epoch[04](4/5): current batch triplet loss = 0.0048, average epoch triplet loss = 0.0192
2022-01-16 21:20:29   Finished epoch 04 in 1:03:39, average epoch triplet loss = 0.0192
2022-01-16 21:20:29   Extracting database features for evaluation/testing
2022-01-16 21:23:35   Extracting queries features for evaluation/testing
2022-01-16 21:25:57   Calculating recalls
2022-01-16 21:26:32   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 96.0, R@10: 97.6, R@20: 98.6
2022-01-16 21:26:33   Improved: previous best R@5 = 95.9, current R@5 = 96.0
2022-01-16 21:26:33   Start training epoch: 05
2022-01-16 21:26:33   Cache: 0 / 5
2022-01-16 21:39:16   Epoch[05](0/5): current batch triplet loss = 0.0051, average epoch triplet loss = 0.0192
2022-01-16 21:39:16   Cache: 1 / 5
2022-01-16 21:52:01   Epoch[05](1/5): current batch triplet loss = 0.0203, average epoch triplet loss = 0.0183
2022-01-16 21:52:01   Cache: 2 / 5
2022-01-16 22:04:49   Epoch[05](2/5): current batch triplet loss = 0.0026, average epoch triplet loss = 0.0185
2022-01-16 22:04:49   Cache: 3 / 5
2022-01-16 22:17:35   Epoch[05](3/5): current batch triplet loss = 0.0064, average epoch triplet loss = 0.0183
2022-01-16 22:17:35   Cache: 4 / 5
2022-01-16 22:30:21   Epoch[05](4/5): current batch triplet loss = 0.0245, average epoch triplet loss = 0.0181
2022-01-16 22:30:21   Finished epoch 05 in 1:03:47, average epoch triplet loss = 0.0181
2022-01-16 22:30:21   Extracting database features for evaluation/testing
2022-01-16 22:33:27   Extracting queries features for evaluation/testing
2022-01-16 22:35:49   Calculating recalls
2022-01-16 22:36:25   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.2, R@5: 95.9, R@10: 97.7, R@20: 98.6
2022-01-16 22:36:26   Not improved: 1 / 3: best R@5 = 96.0, current R@5 = 95.9
2022-01-16 22:36:26   Start training epoch: 06
2022-01-16 22:36:26   Cache: 0 / 5
2022-01-16 22:49:08   Epoch[06](0/5): current batch triplet loss = 0.0352, average epoch triplet loss = 0.0196
2022-01-16 22:49:08   Cache: 1 / 5
2022-01-16 23:01:52   Epoch[06](1/5): current batch triplet loss = 0.0054, average epoch triplet loss = 0.0185
2022-01-16 23:01:52   Cache: 2 / 5
2022-01-16 23:14:36   Epoch[06](2/5): current batch triplet loss = 0.0030, average epoch triplet loss = 0.0182
2022-01-16 23:14:36   Cache: 3 / 5
2022-01-16 23:27:20   Epoch[06](3/5): current batch triplet loss = 0.0115, average epoch triplet loss = 0.0182
2022-01-16 23:27:20   Cache: 4 / 5
2022-01-16 23:40:05   Epoch[06](4/5): current batch triplet loss = 0.0055, average epoch triplet loss = 0.0182
2022-01-16 23:40:05   Finished epoch 06 in 1:03:38, average epoch triplet loss = 0.0182
2022-01-16 23:40:05   Extracting database features for evaluation/testing
2022-01-16 23:43:10   Extracting queries features for evaluation/testing
2022-01-16 23:45:32   Calculating recalls
2022-01-16 23:46:08   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.3, R@5: 96.2, R@10: 97.8, R@20: 98.6
2022-01-16 23:46:09   Improved: previous best R@5 = 96.0, current R@5 = 96.2
2022-01-16 23:46:09   Start training epoch: 07
2022-01-16 23:46:09   Cache: 0 / 5
2022-01-16 23:58:53   Epoch[07](0/5): current batch triplet loss = 0.0206, average epoch triplet loss = 0.0183
2022-01-16 23:58:53   Cache: 1 / 5
2022-01-17 00:11:37   Epoch[07](1/5): current batch triplet loss = 0.0076, average epoch triplet loss = 0.0174
2022-01-17 00:11:38   Cache: 2 / 5
2022-01-17 00:24:22   Epoch[07](2/5): current batch triplet loss = 0.0475, average epoch triplet loss = 0.0173
2022-01-17 00:24:22   Cache: 3 / 5
2022-01-17 00:37:06   Epoch[07](3/5): current batch triplet loss = 0.0114, average epoch triplet loss = 0.0173
2022-01-17 00:37:07   Cache: 4 / 5
2022-01-17 00:49:50   Epoch[07](4/5): current batch triplet loss = 0.0075, average epoch triplet loss = 0.0170
2022-01-17 00:49:50   Finished epoch 07 in 1:03:41, average epoch triplet loss = 0.0170
2022-01-17 00:49:50   Extracting database features for evaluation/testing
2022-01-17 00:52:56   Extracting queries features for evaluation/testing
2022-01-17 00:55:18   Calculating recalls
2022-01-17 00:55:54   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.5, R@5: 96.2, R@10: 97.8, R@20: 98.6
2022-01-17 00:55:56   Improved: previous best R@5 = 96.2, current R@5 = 96.2
2022-01-17 00:55:56   Start training epoch: 08
2022-01-17 00:55:56   Cache: 0 / 5
2022-01-17 01:08:39   Epoch[08](0/5): current batch triplet loss = 0.0034, average epoch triplet loss = 0.0166
2022-01-17 01:08:39   Cache: 1 / 5
2022-01-17 01:21:24   Epoch[08](1/5): current batch triplet loss = 0.0238, average epoch triplet loss = 0.0168
2022-01-17 01:21:24   Cache: 2 / 5
2022-01-17 01:34:10   Epoch[08](2/5): current batch triplet loss = 0.0053, average epoch triplet loss = 0.0169
2022-01-17 01:34:10   Cache: 3 / 5
2022-01-17 01:46:54   Epoch[08](3/5): current batch triplet loss = 0.0178, average epoch triplet loss = 0.0170
2022-01-17 01:46:54   Cache: 4 / 5
2022-01-17 01:59:39   Epoch[08](4/5): current batch triplet loss = 0.0033, average epoch triplet loss = 0.0168
2022-01-17 01:59:39   Finished epoch 08 in 1:03:43, average epoch triplet loss = 0.0168
2022-01-17 01:59:39   Extracting database features for evaluation/testing
2022-01-17 02:02:45   Extracting queries features for evaluation/testing
2022-01-17 02:05:08   Calculating recalls
2022-01-17 02:05:44   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.6, R@5: 96.4, R@10: 97.8, R@20: 98.6
2022-01-17 02:05:45   Improved: previous best R@5 = 96.2, current R@5 = 96.4
2022-01-17 02:05:45   Start training epoch: 09
2022-01-17 02:05:45   Cache: 0 / 5
2022-01-17 02:18:28   Epoch[09](0/5): current batch triplet loss = 0.0228, average epoch triplet loss = 0.0164
2022-01-17 02:18:28   Cache: 1 / 5
2022-01-17 02:31:13   Epoch[09](1/5): current batch triplet loss = 0.0072, average epoch triplet loss = 0.0163
2022-01-17 02:31:13   Cache: 2 / 5
2022-01-17 02:43:58   Epoch[09](2/5): current batch triplet loss = 0.0095, average epoch triplet loss = 0.0162
2022-01-17 02:43:58   Cache: 3 / 5
2022-01-17 02:56:42   Epoch[09](3/5): current batch triplet loss = 0.0239, average epoch triplet loss = 0.0162
2022-01-17 02:56:42   Cache: 4 / 5
2022-01-17 03:09:27   Epoch[09](4/5): current batch triplet loss = 0.0124, average epoch triplet loss = 0.0161
2022-01-17 03:09:27   Finished epoch 09 in 1:03:42, average epoch triplet loss = 0.0161
2022-01-17 03:09:27   Extracting database features for evaluation/testing
2022-01-17 03:12:33   Extracting queries features for evaluation/testing
2022-01-17 03:14:54   Calculating recalls
2022-01-17 03:15:30   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.5, R@5: 96.3, R@10: 97.8, R@20: 98.6
2022-01-17 03:15:31   Not improved: 1 / 3: best R@5 = 96.4, current R@5 = 96.3
2022-01-17 03:15:31   Start training epoch: 10
2022-01-17 03:15:31   Cache: 0 / 5
2022-01-17 03:28:15   Epoch[10](0/5): current batch triplet loss = 0.0030, average epoch triplet loss = 0.0139
2022-01-17 03:28:15   Cache: 1 / 5
2022-01-17 03:40:59   Epoch[10](1/5): current batch triplet loss = 0.0389, average epoch triplet loss = 0.0144
2022-01-17 03:40:59   Cache: 2 / 5
2022-01-17 03:53:43   Epoch[10](2/5): current batch triplet loss = 0.0446, average epoch triplet loss = 0.0148
2022-01-17 03:53:43   Cache: 3 / 5
2022-01-17 04:06:27   Epoch[10](3/5): current batch triplet loss = 0.0120, average epoch triplet loss = 0.0147
2022-01-17 04:06:27   Cache: 4 / 5
2022-01-17 04:19:11   Epoch[10](4/5): current batch triplet loss = 0.0173, average epoch triplet loss = 0.0150
2022-01-17 04:19:11   Finished epoch 10 in 1:03:40, average epoch triplet loss = 0.0150
2022-01-17 04:19:11   Extracting database features for evaluation/testing
2022-01-17 04:22:17   Extracting queries features for evaluation/testing
2022-01-17 04:24:39   Calculating recalls
2022-01-17 04:25:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.6, R@5: 96.3, R@10: 97.8, R@20: 98.7
2022-01-17 04:25:15   Not improved: 2 / 3: best R@5 = 96.4, current R@5 = 96.3
2022-01-17 04:25:15   Start training epoch: 11
2022-01-17 04:25:16   Cache: 0 / 5
2022-01-17 04:37:58   Epoch[11](0/5): current batch triplet loss = 0.0228, average epoch triplet loss = 0.0139
2022-01-17 04:37:58   Cache: 1 / 5
2022-01-17 04:50:42   Epoch[11](1/5): current batch triplet loss = 0.0102, average epoch triplet loss = 0.0142
2022-01-17 04:50:42   Cache: 2 / 5
2022-01-17 05:03:27   Epoch[11](2/5): current batch triplet loss = 0.0260, average epoch triplet loss = 0.0144
2022-01-17 05:03:27   Cache: 3 / 5
2022-01-17 05:16:13   Epoch[11](3/5): current batch triplet loss = 0.0100, average epoch triplet loss = 0.0144
2022-01-17 05:16:13   Cache: 4 / 5
2022-01-17 05:28:57   Epoch[11](4/5): current batch triplet loss = 0.0072, average epoch triplet loss = 0.0146
2022-01-17 05:28:58   Finished epoch 11 in 1:03:42, average epoch triplet loss = 0.0146
2022-01-17 05:28:58   Extracting database features for evaluation/testing
2022-01-17 05:32:03   Extracting queries features for evaluation/testing
2022-01-17 05:34:26   Calculating recalls
2022-01-17 05:35:02   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.1, R@5: 96.0, R@10: 97.7, R@20: 98.6
2022-01-17 05:35:02   Not improved: 3 / 3: best R@5 = 96.4, current R@5 = 96.0
2022-01-17 05:35:02   Performance did not improve for 3 epochs. Stop training.
2022-01-17 05:35:02   Best R@5: 96.4
2022-01-17 05:35:02   Trained for 12 epochs, in total in 13:58:14
2022-01-17 05:35:05   Extracting database features for evaluation/testing
2022-01-17 05:38:09   Extracting queries features for evaluation/testing
2022-01-17 05:40:16   Calculating recalls
2022-01-17 05:40:49   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 86.6, R@5: 93.3, R@10: 95.0, R@20: 96.5
