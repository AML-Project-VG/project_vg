2022-01-20 09:09:07   Arguments: Namespace(attention_lr=0.001, augment_input='None', backbone='resnet50-conv4', cache_refresh_rate=1000, datasets_folder='./Dataset_pitts30k', device='cuda', downscale_input=False, epochs_num=20, exp_name='default', gem_eps=1e-06, gem_p=3, infer_batch_size=16, lr=1e-05, margin=0.1, momentum=0.9, neg_samples_num=1000, negs_num_per_query=10, netvlad_clusters=64, num_workers=4, output_folder='runs/default/2022-01-20_09-09-07', patience=3, queries_per_epoch=5000, recall_values=[1, 5, 10, 20], save_attention_mask=None, seed=0, test_dataset_name=None, test_model_path=None, train_batch_size=2, train_positives_dist_threshold=10, upscale_input=False, use_adagrad=None, use_attention=None, use_gem=None, use_netvlad=True, use_sgd=None, val_positive_dist_threshold=25)
2022-01-20 09:09:07   The outputs are being saved in runs/default/2022-01-20_09-09-07
2022-01-20 09:09:08   Using 1 GPUs and 4 CPUs
2022-01-20 09:09:08   Loading dataset Pitts30k from folder ./Dataset_pitts30k
2022-01-20 09:09:08   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-20 09:09:08   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-20 09:09:08   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-20 09:09:08   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-20 09:09:09   Cut conv5, Train only conv4 of the ResNet-50, freeze the previous ones
2022-01-20 09:09:12   Output dimension of the model is 65536
2022-01-20 09:09:12   Start training epoch: 00
2022-01-20 09:09:12   Cache: 0 / 5
2022-01-20 09:22:29   Epoch[00](0/5): current batch triplet loss = 0.0152, average epoch triplet loss = 0.0319
2022-01-20 09:22:29   Cache: 1 / 5
2022-01-20 09:35:45   Epoch[00](1/5): current batch triplet loss = 0.0470, average epoch triplet loss = 0.0288
2022-01-20 09:35:45   Cache: 2 / 5
2022-01-20 09:49:00   Epoch[00](2/5): current batch triplet loss = 0.0217, average epoch triplet loss = 0.0261
2022-01-20 09:49:00   Cache: 3 / 5
2022-01-20 10:02:17   Epoch[00](3/5): current batch triplet loss = 0.0533, average epoch triplet loss = 0.0244
2022-01-20 10:02:17   Cache: 4 / 5
2022-01-20 10:15:33   Epoch[00](4/5): current batch triplet loss = 0.0001, average epoch triplet loss = 0.0232
2022-01-20 10:15:33   Finished epoch 00 in 1:06:21, average epoch triplet loss = 0.0232
2022-01-20 10:15:33   Extracting database features for evaluation/testing
2022-01-20 10:18:00   Extracting queries features for evaluation/testing
2022-01-20 10:19:52   Calculating recalls
2022-01-20 10:21:53   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.7, R@5: 96.7, R@10: 98.0, R@20: 98.8
2022-01-20 10:21:53   Improved: previous best R@5 = 0.0, current R@5 = 96.7
2022-01-20 10:21:53   Start training epoch: 01
2022-01-20 10:21:53   Cache: 0 / 5
2022-01-20 10:36:01   Epoch[01](0/5): current batch triplet loss = 0.0301, average epoch triplet loss = 0.0171
2022-01-20 10:36:01   Cache: 1 / 5
2022-01-20 10:50:09   Epoch[01](1/5): current batch triplet loss = 0.0330, average epoch triplet loss = 0.0166
2022-01-20 10:50:09   Cache: 2 / 5
2022-01-20 11:04:15   Epoch[01](2/5): current batch triplet loss = 0.0290, average epoch triplet loss = 0.0157
2022-01-20 11:04:15   Cache: 3 / 5
2022-01-20 11:18:23   Epoch[01](3/5): current batch triplet loss = 0.0122, average epoch triplet loss = 0.0154
2022-01-20 11:18:23   Cache: 4 / 5
2022-01-20 11:32:30   Epoch[01](4/5): current batch triplet loss = 0.0191, average epoch triplet loss = 0.0151
2022-01-20 11:32:30   Finished epoch 01 in 1:10:36, average epoch triplet loss = 0.0151
2022-01-20 11:32:30   Extracting database features for evaluation/testing
2022-01-20 11:34:55   Extracting queries features for evaluation/testing
2022-01-20 11:36:46   Calculating recalls
2022-01-20 11:38:48   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 89.1, R@5: 96.8, R@10: 98.0, R@20: 98.7
2022-01-20 11:38:48   Improved: previous best R@5 = 96.7, current R@5 = 96.8
2022-01-20 11:38:48   Start training epoch: 02
2022-01-20 11:38:48   Cache: 0 / 5
2022-01-20 11:52:36   Epoch[02](0/5): current batch triplet loss = 0.0080, average epoch triplet loss = 0.0115
2022-01-20 11:52:36   Cache: 1 / 5
2022-01-20 12:06:25   Epoch[02](1/5): current batch triplet loss = 0.0071, average epoch triplet loss = 0.0114
2022-01-20 12:06:25   Cache: 2 / 5
2022-01-20 12:20:13   Epoch[02](2/5): current batch triplet loss = 0.0001, average epoch triplet loss = 0.0114
2022-01-20 12:20:13   Cache: 3 / 5
2022-01-20 12:34:03   Epoch[02](3/5): current batch triplet loss = 0.0059, average epoch triplet loss = 0.0112
2022-01-20 12:34:03   Cache: 4 / 5
2022-01-20 12:47:52   Epoch[02](4/5): current batch triplet loss = 0.0056, average epoch triplet loss = 0.0110
2022-01-20 12:47:52   Finished epoch 02 in 1:09:04, average epoch triplet loss = 0.0110
2022-01-20 12:47:52   Extracting database features for evaluation/testing
2022-01-20 12:50:17   Extracting queries features for evaluation/testing
2022-01-20 12:52:07   Calculating recalls
2022-01-20 12:54:10   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.9, R@5: 96.3, R@10: 97.8, R@20: 98.6
2022-01-20 12:54:10   Not improved: 1 / 3: best R@5 = 96.8, current R@5 = 96.3
2022-01-20 12:54:10   Start training epoch: 03
2022-01-20 12:54:10   Cache: 0 / 5
2022-01-20 13:08:08   Epoch[03](0/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0092
2022-01-20 13:08:08   Cache: 1 / 5
2022-01-20 13:22:06   Epoch[03](1/5): current batch triplet loss = 0.0025, average epoch triplet loss = 0.0096
2022-01-20 13:22:06   Cache: 2 / 5
2022-01-20 13:36:04   Epoch[03](2/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0096
2022-01-20 13:36:04   Cache: 3 / 5
2022-01-20 13:50:01   Epoch[03](3/5): current batch triplet loss = 0.0958, average epoch triplet loss = 0.0095
2022-01-20 13:50:01   Cache: 4 / 5
2022-01-20 14:03:59   Epoch[03](4/5): current batch triplet loss = 0.0218, average epoch triplet loss = 0.0094
2022-01-20 14:03:59   Finished epoch 03 in 1:09:49, average epoch triplet loss = 0.0094
2022-01-20 14:03:59   Extracting database features for evaluation/testing
2022-01-20 14:06:23   Extracting queries features for evaluation/testing
2022-01-20 14:08:14   Calculating recalls
2022-01-20 14:10:16   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 89.2, R@5: 96.5, R@10: 97.9, R@20: 98.6
2022-01-20 14:10:16   Not improved: 2 / 3: best R@5 = 96.8, current R@5 = 96.5
2022-01-20 14:10:16   Start training epoch: 04
2022-01-20 14:10:16   Cache: 0 / 5
2022-01-20 14:24:24   Epoch[04](0/5): current batch triplet loss = 0.0000, average epoch triplet loss = 0.0086
2022-01-20 14:24:24   Cache: 1 / 5
2022-01-20 14:38:28   Epoch[04](1/5): current batch triplet loss = 0.0046, average epoch triplet loss = 0.0082
2022-01-20 14:38:28   Cache: 2 / 5
2022-01-20 14:52:34   Epoch[04](2/5): current batch triplet loss = 0.0004, average epoch triplet loss = 0.0083
2022-01-20 14:52:34   Cache: 3 / 5
2022-01-20 15:06:39   Epoch[04](3/5): current batch triplet loss = 0.0067, average epoch triplet loss = 0.0085
2022-01-20 15:06:39   Cache: 4 / 5
2022-01-20 15:20:43   Epoch[04](4/5): current batch triplet loss = 0.0009, average epoch triplet loss = 0.0083
2022-01-20 15:20:43   Finished epoch 04 in 1:10:26, average epoch triplet loss = 0.0083
2022-01-20 15:20:43   Extracting database features for evaluation/testing
2022-01-20 15:23:08   Extracting queries features for evaluation/testing
2022-01-20 15:24:58   Calculating recalls
2022-01-20 15:27:00   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 88.8, R@5: 96.5, R@10: 97.9, R@20: 98.8
2022-01-20 15:27:00   Not improved: 3 / 3: best R@5 = 96.8, current R@5 = 96.5
2022-01-20 15:27:00   Performance did not improve for 3 epochs. Stop training.
2022-01-20 15:27:00   Best R@5: 96.8
2022-01-20 15:27:00   Trained for 05 epochs, in total in 6:17:52
2022-01-20 15:27:00   Extracting database features for evaluation/testing
2022-01-20 15:29:25   Extracting queries features for evaluation/testing
2022-01-20 15:31:04   Calculating recalls
2022-01-20 15:32:53   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 86.3, R@5: 92.9, R@10: 94.7, R@20: 96.5
