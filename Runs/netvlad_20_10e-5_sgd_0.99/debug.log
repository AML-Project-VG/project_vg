2022-01-16 01:37:59   Arguments: Namespace(upscale_input=False, downscale_input=False, augment_input='None', backbone='resnet18', use_netvlad=True, netvlad_clusters=64, use_gem=None, gem_p=3, gem_eps=1e-06, use_sgd=True, use_adagrad=None, momentum=0.99, train_batch_size=4, infer_batch_size=16, margin=0.1, epochs_num=20, patience=3, lr=1e-05, cache_refresh_rate=1000, queries_per_epoch=5000, negs_num_per_query=10, neg_samples_num=1000, seed=0, device='cuda', num_workers=8, val_positive_dist_threshold=25, train_positives_dist_threshold=10, recall_values=[1, 5, 10, 20], datasets_folder='./Dataset_pitts30k', exp_name='default', test_dataset_name=None, test_model_path=None, output_folder='runs/default/2022-01-16_01-37-59')
2022-01-16 01:37:59   The outputs are being saved in runs/default/2022-01-16_01-37-59
2022-01-16 01:37:59   Using 1 GPUs and 12 CPUs
2022-01-16 01:37:59   Loading dataset Pitts30k from folder ./Dataset_pitts30k
2022-01-16 01:37:59   There are 96 queries without any positives within the training set. They won't be considered as they're useless for training.
2022-01-16 01:37:59   Train query set: < TripletsDataset, pitts30k - #database: 10000; #queries: 7320 >
2022-01-16 01:38:00   Val set: < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >
2022-01-16 01:38:00   Test set: < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >
2022-01-16 01:38:00   Train only conv4 of the ResNet-18 (remove conv5), freeze the previous ones
2022-01-16 01:38:05   Output dimension of the model is 16384
2022-01-16 01:38:05   Start training epoch: 00
2022-01-16 01:38:05   Cache: 0 / 5
2022-01-16 01:40:55   Epoch[00](0/5): current batch triplet loss = 0.0546, average epoch triplet loss = 0.0458
2022-01-16 01:40:55   Cache: 1 / 5
2022-01-16 01:43:53   Epoch[00](1/5): current batch triplet loss = 0.0705, average epoch triplet loss = 0.0462
2022-01-16 01:43:53   Cache: 2 / 5
2022-01-16 01:46:49   Epoch[00](2/5): current batch triplet loss = 0.0332, average epoch triplet loss = 0.0459
2022-01-16 01:46:49   Cache: 3 / 5
2022-01-16 01:49:44   Epoch[00](3/5): current batch triplet loss = 0.0644, average epoch triplet loss = 0.0455
2022-01-16 01:49:44   Cache: 4 / 5
2022-01-16 01:52:37   Epoch[00](4/5): current batch triplet loss = 0.0854, average epoch triplet loss = 0.0457
2022-01-16 01:52:37   Finished epoch 00 in 0:14:32, average epoch triplet loss = 0.0457
2022-01-16 01:52:37   Extracting database features for evaluation/testing
2022-01-16 01:53:12   Extracting queries features for evaluation/testing
2022-01-16 01:54:02   Calculating recalls
2022-01-16 01:54:27   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 72.1, R@5: 86.5, R@10: 90.8, R@20: 94.2
2022-01-16 01:54:27   Improved: previous best R@5 = 0.0, current R@5 = 86.5
2022-01-16 01:54:27   Start training epoch: 01
2022-01-16 01:54:27   Cache: 0 / 5
2022-01-16 01:57:20   Epoch[01](0/5): current batch triplet loss = 0.0538, average epoch triplet loss = 0.0440
2022-01-16 01:57:20   Cache: 1 / 5
2022-01-16 02:00:12   Epoch[01](1/5): current batch triplet loss = 0.0397, average epoch triplet loss = 0.0435
2022-01-16 02:00:12   Cache: 2 / 5
2022-01-16 02:03:05   Epoch[01](2/5): current batch triplet loss = 0.0632, average epoch triplet loss = 0.0433
2022-01-16 02:03:05   Cache: 3 / 5
2022-01-16 02:05:57   Epoch[01](3/5): current batch triplet loss = 0.0461, average epoch triplet loss = 0.0434
2022-01-16 02:05:57   Cache: 4 / 5
2022-01-16 02:08:50   Epoch[01](4/5): current batch triplet loss = 0.0806, average epoch triplet loss = 0.0436
2022-01-16 02:08:50   Finished epoch 01 in 0:14:22, average epoch triplet loss = 0.0436
2022-01-16 02:08:50   Extracting database features for evaluation/testing
2022-01-16 02:09:25   Extracting queries features for evaluation/testing
2022-01-16 02:10:21   Calculating recalls
2022-01-16 02:10:47   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 76.6, R@5: 89.5, R@10: 93.2, R@20: 95.8
2022-01-16 02:10:48   Improved: previous best R@5 = 86.5, current R@5 = 89.5
2022-01-16 02:10:48   Start training epoch: 02
2022-01-16 02:10:48   Cache: 0 / 5
2022-01-16 02:13:44   Epoch[02](0/5): current batch triplet loss = 0.0397, average epoch triplet loss = 0.0423
2022-01-16 02:13:44   Cache: 1 / 5
2022-01-16 02:16:40   Epoch[02](1/5): current batch triplet loss = 0.0325, average epoch triplet loss = 0.0432
2022-01-16 02:16:40   Cache: 2 / 5
2022-01-16 02:19:32   Epoch[02](2/5): current batch triplet loss = 0.0211, average epoch triplet loss = 0.0430
2022-01-16 02:19:32   Cache: 3 / 5
2022-01-16 02:22:25   Epoch[02](3/5): current batch triplet loss = 0.0395, average epoch triplet loss = 0.0428
2022-01-16 02:22:25   Cache: 4 / 5
2022-01-16 02:25:18   Epoch[02](4/5): current batch triplet loss = 0.0393, average epoch triplet loss = 0.0429
2022-01-16 02:25:18   Finished epoch 02 in 0:14:30, average epoch triplet loss = 0.0429
2022-01-16 02:25:18   Extracting database features for evaluation/testing
2022-01-16 02:25:53   Extracting queries features for evaluation/testing
2022-01-16 02:26:49   Calculating recalls
2022-01-16 02:27:15   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 79.1, R@5: 91.0, R@10: 94.2, R@20: 96.5
2022-01-16 02:27:16   Improved: previous best R@5 = 89.5, current R@5 = 91.0
2022-01-16 02:27:16   Start training epoch: 03
2022-01-16 02:27:16   Cache: 0 / 5
2022-01-16 02:30:08   Epoch[03](0/5): current batch triplet loss = 0.0133, average epoch triplet loss = 0.0397
2022-01-16 02:30:08   Cache: 1 / 5
2022-01-16 02:33:01   Epoch[03](1/5): current batch triplet loss = 0.0352, average epoch triplet loss = 0.0409
2022-01-16 02:33:01   Cache: 2 / 5
2022-01-16 02:35:53   Epoch[03](2/5): current batch triplet loss = 0.0329, average epoch triplet loss = 0.0419
2022-01-16 02:35:53   Cache: 3 / 5
2022-01-16 02:38:45   Epoch[03](3/5): current batch triplet loss = 0.0735, average epoch triplet loss = 0.0420
2022-01-16 02:38:45   Cache: 4 / 5
2022-01-16 02:41:37   Epoch[03](4/5): current batch triplet loss = 0.0542, average epoch triplet loss = 0.0423
2022-01-16 02:41:37   Finished epoch 03 in 0:14:21, average epoch triplet loss = 0.0423
2022-01-16 02:41:37   Extracting database features for evaluation/testing
2022-01-16 02:42:13   Extracting queries features for evaluation/testing
2022-01-16 02:42:56   Calculating recalls
2022-01-16 02:43:17   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 81.1, R@5: 92.5, R@10: 95.2, R@20: 97.1
2022-01-16 02:43:17   Improved: previous best R@5 = 91.0, current R@5 = 92.5
2022-01-16 02:43:17   Start training epoch: 04
2022-01-16 02:43:17   Cache: 0 / 5
2022-01-16 02:46:10   Epoch[04](0/5): current batch triplet loss = 0.0178, average epoch triplet loss = 0.0421
2022-01-16 02:46:10   Cache: 1 / 5
2022-01-16 02:49:02   Epoch[04](1/5): current batch triplet loss = 0.0340, average epoch triplet loss = 0.0417
2022-01-16 02:49:02   Cache: 2 / 5
2022-01-16 02:51:55   Epoch[04](2/5): current batch triplet loss = 0.0467, average epoch triplet loss = 0.0419
2022-01-16 02:51:55   Cache: 3 / 5
2022-01-16 02:54:47   Epoch[04](3/5): current batch triplet loss = 0.0316, average epoch triplet loss = 0.0424
2022-01-16 02:54:47   Cache: 4 / 5
2022-01-16 02:57:39   Epoch[04](4/5): current batch triplet loss = 0.0502, average epoch triplet loss = 0.0425
2022-01-16 02:57:39   Finished epoch 04 in 0:14:21, average epoch triplet loss = 0.0425
2022-01-16 02:57:39   Extracting database features for evaluation/testing
2022-01-16 02:58:15   Extracting queries features for evaluation/testing
2022-01-16 02:59:15   Calculating recalls
2022-01-16 02:59:46   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 82.6, R@5: 93.0, R@10: 95.6, R@20: 97.5
2022-01-16 02:59:46   Improved: previous best R@5 = 92.5, current R@5 = 93.0
2022-01-16 02:59:46   Start training epoch: 05
2022-01-16 02:59:46   Cache: 0 / 5
2022-01-16 03:02:40   Epoch[05](0/5): current batch triplet loss = 0.0250, average epoch triplet loss = 0.0442
2022-01-16 03:02:40   Cache: 1 / 5
2022-01-16 03:05:32   Epoch[05](1/5): current batch triplet loss = 0.0426, average epoch triplet loss = 0.0428
2022-01-16 03:05:32   Cache: 2 / 5
2022-01-16 03:08:25   Epoch[05](2/5): current batch triplet loss = 0.0095, average epoch triplet loss = 0.0430
2022-01-16 03:08:25   Cache: 3 / 5
2022-01-16 03:11:18   Epoch[05](3/5): current batch triplet loss = 0.0208, average epoch triplet loss = 0.0429
2022-01-16 03:11:18   Cache: 4 / 5
2022-01-16 03:14:10   Epoch[05](4/5): current batch triplet loss = 0.0355, average epoch triplet loss = 0.0428
2022-01-16 03:14:10   Finished epoch 05 in 0:14:23, average epoch triplet loss = 0.0428
2022-01-16 03:14:10   Extracting database features for evaluation/testing
2022-01-16 03:14:45   Extracting queries features for evaluation/testing
2022-01-16 03:15:39   Calculating recalls
2022-01-16 03:16:09   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.2, R@5: 93.6, R@10: 96.0, R@20: 97.8
2022-01-16 03:16:10   Improved: previous best R@5 = 93.0, current R@5 = 93.6
2022-01-16 03:16:10   Start training epoch: 06
2022-01-16 03:16:10   Cache: 0 / 5
2022-01-16 03:19:03   Epoch[06](0/5): current batch triplet loss = 0.0674, average epoch triplet loss = 0.0436
2022-01-16 03:19:03   Cache: 1 / 5
2022-01-16 03:21:55   Epoch[06](1/5): current batch triplet loss = 0.0248, average epoch triplet loss = 0.0428
2022-01-16 03:21:55   Cache: 2 / 5
2022-01-16 03:24:48   Epoch[06](2/5): current batch triplet loss = 0.0075, average epoch triplet loss = 0.0423
2022-01-16 03:24:48   Cache: 3 / 5
2022-01-16 03:27:40   Epoch[06](3/5): current batch triplet loss = 0.0531, average epoch triplet loss = 0.0429
2022-01-16 03:27:40   Cache: 4 / 5
2022-01-16 03:30:33   Epoch[06](4/5): current batch triplet loss = 0.0237, average epoch triplet loss = 0.0430
2022-01-16 03:30:33   Finished epoch 06 in 0:14:23, average epoch triplet loss = 0.0430
2022-01-16 03:30:33   Extracting database features for evaluation/testing
2022-01-16 03:31:08   Extracting queries features for evaluation/testing
2022-01-16 03:32:00   Calculating recalls
2022-01-16 03:32:28   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 83.9, R@5: 93.9, R@10: 96.3, R@20: 97.9
2022-01-16 03:32:28   Improved: previous best R@5 = 93.6, current R@5 = 93.9
2022-01-16 03:32:28   Start training epoch: 07
2022-01-16 03:32:28   Cache: 0 / 5
2022-01-16 03:35:21   Epoch[07](0/5): current batch triplet loss = 0.0318, average epoch triplet loss = 0.0448
2022-01-16 03:35:21   Cache: 1 / 5
2022-01-16 03:38:14   Epoch[07](1/5): current batch triplet loss = 0.0158, average epoch triplet loss = 0.0423
2022-01-16 03:38:14   Cache: 2 / 5
2022-01-16 03:41:07   Epoch[07](2/5): current batch triplet loss = 0.0674, average epoch triplet loss = 0.0423
2022-01-16 03:41:07   Cache: 3 / 5
2022-01-16 03:44:00   Epoch[07](3/5): current batch triplet loss = 0.0347, average epoch triplet loss = 0.0428
2022-01-16 03:44:00   Cache: 4 / 5
2022-01-16 03:46:52   Epoch[07](4/5): current batch triplet loss = 0.0418, average epoch triplet loss = 0.0425
2022-01-16 03:46:52   Finished epoch 07 in 0:14:24, average epoch triplet loss = 0.0425
2022-01-16 03:46:52   Extracting database features for evaluation/testing
2022-01-16 03:47:28   Extracting queries features for evaluation/testing
2022-01-16 03:48:07   Calculating recalls
2022-01-16 03:48:39   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 84.1, R@5: 94.2, R@10: 96.3, R@20: 97.9
2022-01-16 03:48:39   Improved: previous best R@5 = 93.9, current R@5 = 94.2
2022-01-16 03:48:39   Start training epoch: 08
2022-01-16 03:48:39   Cache: 0 / 5
2022-01-16 03:51:32   Epoch[08](0/5): current batch triplet loss = 0.0336, average epoch triplet loss = 0.0432
2022-01-16 03:51:32   Cache: 1 / 5
2022-01-16 03:54:25   Epoch[08](1/5): current batch triplet loss = 0.0598, average epoch triplet loss = 0.0429
2022-01-16 03:54:25   Cache: 2 / 5
2022-01-16 03:57:17   Epoch[08](2/5): current batch triplet loss = 0.0161, average epoch triplet loss = 0.0430
2022-01-16 03:57:17   Cache: 3 / 5
2022-01-16 04:00:10   Epoch[08](3/5): current batch triplet loss = 0.0462, average epoch triplet loss = 0.0430
2022-01-16 04:00:10   Cache: 4 / 5
2022-01-16 04:03:02   Epoch[08](4/5): current batch triplet loss = 0.0249, average epoch triplet loss = 0.0429
2022-01-16 04:03:02   Finished epoch 08 in 0:14:23, average epoch triplet loss = 0.0429
2022-01-16 04:03:02   Extracting database features for evaluation/testing
2022-01-16 04:03:37   Extracting queries features for evaluation/testing
2022-01-16 04:04:21   Calculating recalls
2022-01-16 04:04:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 85.3, R@5: 94.5, R@10: 96.7, R@20: 98.3
2022-01-16 04:04:52   Improved: previous best R@5 = 94.2, current R@5 = 94.5
2022-01-16 04:04:52   Start training epoch: 09
2022-01-16 04:04:52   Cache: 0 / 5
2022-01-16 04:07:45   Epoch[09](0/5): current batch triplet loss = 0.0546, average epoch triplet loss = 0.0436
2022-01-16 04:07:45   Cache: 1 / 5
2022-01-16 04:10:37   Epoch[09](1/5): current batch triplet loss = 0.0462, average epoch triplet loss = 0.0429
2022-01-16 04:10:37   Cache: 2 / 5
2022-01-16 04:13:29   Epoch[09](2/5): current batch triplet loss = 0.0380, average epoch triplet loss = 0.0429
2022-01-16 04:13:29   Cache: 3 / 5
2022-01-16 04:16:22   Epoch[09](3/5): current batch triplet loss = 0.0459, average epoch triplet loss = 0.0428
2022-01-16 04:16:22   Cache: 4 / 5
2022-01-16 04:19:14   Epoch[09](4/5): current batch triplet loss = 0.0282, average epoch triplet loss = 0.0428
2022-01-16 04:19:14   Finished epoch 09 in 0:14:21, average epoch triplet loss = 0.0428
2022-01-16 04:19:14   Extracting database features for evaluation/testing
2022-01-16 04:19:49   Extracting queries features for evaluation/testing
2022-01-16 04:20:35   Calculating recalls
2022-01-16 04:21:03   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 85.2, R@5: 94.4, R@10: 96.6, R@20: 98.2
2022-01-16 04:21:04   Not improved: 1 / 3: best R@5 = 94.5, current R@5 = 94.4
2022-01-16 04:21:04   Start training epoch: 10
2022-01-16 04:21:04   Cache: 0 / 5
2022-01-16 04:23:56   Epoch[10](0/5): current batch triplet loss = 0.0193, average epoch triplet loss = 0.0412
2022-01-16 04:23:56   Cache: 1 / 5
2022-01-16 04:26:49   Epoch[10](1/5): current batch triplet loss = 0.0916, average epoch triplet loss = 0.0414
2022-01-16 04:26:49   Cache: 2 / 5
2022-01-16 04:29:41   Epoch[10](2/5): current batch triplet loss = 0.1019, average epoch triplet loss = 0.0411
2022-01-16 04:29:41   Cache: 3 / 5
2022-01-16 04:32:34   Epoch[10](3/5): current batch triplet loss = 0.0384, average epoch triplet loss = 0.0412
2022-01-16 04:32:34   Cache: 4 / 5
2022-01-16 04:35:27   Epoch[10](4/5): current batch triplet loss = 0.0276, average epoch triplet loss = 0.0416
2022-01-16 04:35:27   Finished epoch 10 in 0:14:23, average epoch triplet loss = 0.0416
2022-01-16 04:35:27   Extracting database features for evaluation/testing
2022-01-16 04:36:02   Extracting queries features for evaluation/testing
2022-01-16 04:36:49   Calculating recalls
2022-01-16 04:37:26   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 85.7, R@5: 94.7, R@10: 96.7, R@20: 98.2
2022-01-16 04:37:26   Improved: previous best R@5 = 94.5, current R@5 = 94.7
2022-01-16 04:37:26   Start training epoch: 11
2022-01-16 04:37:26   Cache: 0 / 5
2022-01-16 04:40:18   Epoch[11](0/5): current batch triplet loss = 0.0408, average epoch triplet loss = 0.0399
2022-01-16 04:40:18   Cache: 1 / 5
2022-01-16 04:43:10   Epoch[11](1/5): current batch triplet loss = 0.0345, average epoch triplet loss = 0.0411
2022-01-16 04:43:10   Cache: 2 / 5
2022-01-16 04:46:03   Epoch[11](2/5): current batch triplet loss = 0.0606, average epoch triplet loss = 0.0415
2022-01-16 04:46:03   Cache: 3 / 5
2022-01-16 04:48:55   Epoch[11](3/5): current batch triplet loss = 0.0400, average epoch triplet loss = 0.0416
2022-01-16 04:48:55   Cache: 4 / 5
2022-01-16 04:51:47   Epoch[11](4/5): current batch triplet loss = 0.0398, average epoch triplet loss = 0.0417
2022-01-16 04:51:47   Finished epoch 11 in 0:14:21, average epoch triplet loss = 0.0417
2022-01-16 04:51:47   Extracting database features for evaluation/testing
2022-01-16 04:52:22   Extracting queries features for evaluation/testing
2022-01-16 04:53:06   Calculating recalls
2022-01-16 04:53:38   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 85.3, R@5: 94.6, R@10: 96.8, R@20: 98.2
2022-01-16 04:53:38   Not improved: 1 / 3: best R@5 = 94.7, current R@5 = 94.6
2022-01-16 04:53:38   Start training epoch: 12
2022-01-16 04:53:38   Cache: 0 / 5
2022-01-16 04:56:30   Epoch[12](0/5): current batch triplet loss = 0.0665, average epoch triplet loss = 0.0401
2022-01-16 04:56:30   Cache: 1 / 5
2022-01-16 04:59:22   Epoch[12](1/5): current batch triplet loss = 0.0512, average epoch triplet loss = 0.0416
2022-01-16 04:59:22   Cache: 2 / 5
2022-01-16 05:02:15   Epoch[12](2/5): current batch triplet loss = 0.0042, average epoch triplet loss = 0.0413
2022-01-16 05:02:15   Cache: 3 / 5
2022-01-16 05:05:07   Epoch[12](3/5): current batch triplet loss = 0.0535, average epoch triplet loss = 0.0423
2022-01-16 05:05:07   Cache: 4 / 5
2022-01-16 05:08:00   Epoch[12](4/5): current batch triplet loss = 0.0660, average epoch triplet loss = 0.0424
2022-01-16 05:08:00   Finished epoch 12 in 0:14:21, average epoch triplet loss = 0.0424
2022-01-16 05:08:00   Extracting database features for evaluation/testing
2022-01-16 05:08:35   Extracting queries features for evaluation/testing
2022-01-16 05:09:18   Calculating recalls
2022-01-16 05:09:40   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.1, R@5: 94.7, R@10: 96.8, R@20: 98.2
2022-01-16 05:09:40   Improved: previous best R@5 = 94.7, current R@5 = 94.7
2022-01-16 05:09:40   Start training epoch: 13
2022-01-16 05:09:40   Cache: 0 / 5
2022-01-16 05:12:32   Epoch[13](0/5): current batch triplet loss = 0.0594, average epoch triplet loss = 0.0425
2022-01-16 05:12:32   Cache: 1 / 5
2022-01-16 05:15:24   Epoch[13](1/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0428
2022-01-16 05:15:24   Cache: 2 / 5
2022-01-16 05:18:17   Epoch[13](2/5): current batch triplet loss = 0.0448, average epoch triplet loss = 0.0424
2022-01-16 05:18:17   Cache: 3 / 5
2022-01-16 05:21:10   Epoch[13](3/5): current batch triplet loss = 0.0565, average epoch triplet loss = 0.0422
2022-01-16 05:21:10   Cache: 4 / 5
2022-01-16 05:24:03   Epoch[13](4/5): current batch triplet loss = 0.0430, average epoch triplet loss = 0.0420
2022-01-16 05:24:03   Finished epoch 13 in 0:14:22, average epoch triplet loss = 0.0420
2022-01-16 05:24:03   Extracting database features for evaluation/testing
2022-01-16 05:24:38   Extracting queries features for evaluation/testing
2022-01-16 05:25:19   Calculating recalls
2022-01-16 05:25:50   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.6, R@5: 95.1, R@10: 97.1, R@20: 98.3
2022-01-16 05:25:50   Improved: previous best R@5 = 94.7, current R@5 = 95.1
2022-01-16 05:25:50   Start training epoch: 14
2022-01-16 05:25:50   Cache: 0 / 5
2022-01-16 05:28:43   Epoch[14](0/5): current batch triplet loss = 0.0133, average epoch triplet loss = 0.0443
2022-01-16 05:28:43   Cache: 1 / 5
2022-01-16 05:31:36   Epoch[14](1/5): current batch triplet loss = 0.0687, average epoch triplet loss = 0.0429
2022-01-16 05:31:36   Cache: 2 / 5
2022-01-16 05:34:28   Epoch[14](2/5): current batch triplet loss = 0.0335, average epoch triplet loss = 0.0426
2022-01-16 05:34:28   Cache: 3 / 5
2022-01-16 05:37:21   Epoch[14](3/5): current batch triplet loss = 0.0359, average epoch triplet loss = 0.0427
2022-01-16 05:37:21   Cache: 4 / 5
2022-01-16 05:40:13   Epoch[14](4/5): current batch triplet loss = 0.0834, average epoch triplet loss = 0.0427
2022-01-16 05:40:13   Finished epoch 14 in 0:14:22, average epoch triplet loss = 0.0427
2022-01-16 05:40:13   Extracting database features for evaluation/testing
2022-01-16 05:40:48   Extracting queries features for evaluation/testing
2022-01-16 05:41:43   Calculating recalls
2022-01-16 05:42:12   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.2, R@5: 95.0, R@10: 97.0, R@20: 98.2
2022-01-16 05:42:12   Not improved: 1 / 3: best R@5 = 95.1, current R@5 = 95.0
2022-01-16 05:42:12   Start training epoch: 15
2022-01-16 05:42:12   Cache: 0 / 5
2022-01-16 05:45:04   Epoch[15](0/5): current batch triplet loss = 0.0376, average epoch triplet loss = 0.0419
2022-01-16 05:45:04   Cache: 1 / 5
2022-01-16 05:47:57   Epoch[15](1/5): current batch triplet loss = 0.0333, average epoch triplet loss = 0.0408
2022-01-16 05:47:57   Cache: 2 / 5
2022-01-16 05:50:50   Epoch[15](2/5): current batch triplet loss = 0.0214, average epoch triplet loss = 0.0410
2022-01-16 05:50:50   Cache: 3 / 5
2022-01-16 05:53:42   Epoch[15](3/5): current batch triplet loss = 0.0411, average epoch triplet loss = 0.0413
2022-01-16 05:53:42   Cache: 4 / 5
2022-01-16 05:56:35   Epoch[15](4/5): current batch triplet loss = 0.0690, average epoch triplet loss = 0.0414
2022-01-16 05:56:35   Finished epoch 15 in 0:14:23, average epoch triplet loss = 0.0414
2022-01-16 05:56:35   Extracting database features for evaluation/testing
2022-01-16 05:57:11   Extracting queries features for evaluation/testing
2022-01-16 05:58:01   Calculating recalls
2022-01-16 05:58:22   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.4, R@5: 95.0, R@10: 97.0, R@20: 98.2
2022-01-16 05:58:22   Not improved: 2 / 3: best R@5 = 95.1, current R@5 = 95.0
2022-01-16 05:58:22   Start training epoch: 16
2022-01-16 05:58:22   Cache: 0 / 5
2022-01-16 06:01:14   Epoch[16](0/5): current batch triplet loss = 0.0461, average epoch triplet loss = 0.0417
2022-01-16 06:01:14   Cache: 1 / 5
2022-01-16 06:04:07   Epoch[16](1/5): current batch triplet loss = 0.0372, average epoch triplet loss = 0.0414
2022-01-16 06:04:07   Cache: 2 / 5
2022-01-16 06:07:00   Epoch[16](2/5): current batch triplet loss = 0.0104, average epoch triplet loss = 0.0416
2022-01-16 06:07:00   Cache: 3 / 5
2022-01-16 06:09:52   Epoch[16](3/5): current batch triplet loss = 0.0263, average epoch triplet loss = 0.0423
2022-01-16 06:09:52   Cache: 4 / 5
2022-01-16 06:12:45   Epoch[16](4/5): current batch triplet loss = 0.0389, average epoch triplet loss = 0.0424
2022-01-16 06:12:45   Finished epoch 16 in 0:14:22, average epoch triplet loss = 0.0424
2022-01-16 06:12:45   Extracting database features for evaluation/testing
2022-01-16 06:13:20   Extracting queries features for evaluation/testing
2022-01-16 06:14:02   Calculating recalls
2022-01-16 06:14:23   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.5, R@5: 95.1, R@10: 97.1, R@20: 98.3
2022-01-16 06:14:23   Improved: previous best R@5 = 95.1, current R@5 = 95.1
2022-01-16 06:14:23   Start training epoch: 17
2022-01-16 06:14:23   Cache: 0 / 5
2022-01-16 06:17:16   Epoch[17](0/5): current batch triplet loss = 0.0346, average epoch triplet loss = 0.0410
2022-01-16 06:17:16   Cache: 1 / 5
2022-01-16 06:20:09   Epoch[17](1/5): current batch triplet loss = 0.0211, average epoch triplet loss = 0.0415
2022-01-16 06:20:09   Cache: 2 / 5
2022-01-16 06:23:02   Epoch[17](2/5): current batch triplet loss = 0.0722, average epoch triplet loss = 0.0421
2022-01-16 06:23:02   Cache: 3 / 5
2022-01-16 06:25:54   Epoch[17](3/5): current batch triplet loss = 0.0559, average epoch triplet loss = 0.0416
2022-01-16 06:25:54   Cache: 4 / 5
2022-01-16 06:28:47   Epoch[17](4/5): current batch triplet loss = 0.0594, average epoch triplet loss = 0.0419
2022-01-16 06:28:47   Finished epoch 17 in 0:14:23, average epoch triplet loss = 0.0419
2022-01-16 06:28:47   Extracting database features for evaluation/testing
2022-01-16 06:29:22   Extracting queries features for evaluation/testing
2022-01-16 06:30:11   Calculating recalls
2022-01-16 06:30:33   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.6, R@5: 95.1, R@10: 97.1, R@20: 98.3
2022-01-16 06:30:33   Not improved: 1 / 3: best R@5 = 95.1, current R@5 = 95.1
2022-01-16 06:30:33   Start training epoch: 18
2022-01-16 06:30:33   Cache: 0 / 5
2022-01-16 06:33:26   Epoch[18](0/5): current batch triplet loss = 0.0303, average epoch triplet loss = 0.0414
2022-01-16 06:33:26   Cache: 1 / 5
2022-01-16 06:36:18   Epoch[18](1/5): current batch triplet loss = 0.0481, average epoch triplet loss = 0.0427
2022-01-16 06:36:18   Cache: 2 / 5
2022-01-16 06:39:11   Epoch[18](2/5): current batch triplet loss = 0.0330, average epoch triplet loss = 0.0414
2022-01-16 06:39:11   Cache: 3 / 5
2022-01-16 06:42:04   Epoch[18](3/5): current batch triplet loss = 0.0286, average epoch triplet loss = 0.0412
2022-01-16 06:42:04   Cache: 4 / 5
2022-01-16 06:44:57   Epoch[18](4/5): current batch triplet loss = 0.0133, average epoch triplet loss = 0.0414
2022-01-16 06:44:57   Finished epoch 18 in 0:14:23, average epoch triplet loss = 0.0414
2022-01-16 06:44:57   Extracting database features for evaluation/testing
2022-01-16 06:45:32   Extracting queries features for evaluation/testing
2022-01-16 06:46:21   Calculating recalls
2022-01-16 06:46:43   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 86.7, R@5: 95.4, R@10: 97.2, R@20: 98.4
2022-01-16 06:46:43   Improved: previous best R@5 = 95.1, current R@5 = 95.4
2022-01-16 06:46:43   Start training epoch: 19
2022-01-16 06:46:43   Cache: 0 / 5
2022-01-16 06:49:36   Epoch[19](0/5): current batch triplet loss = 0.0479, average epoch triplet loss = 0.0420
2022-01-16 06:49:36   Cache: 1 / 5
2022-01-16 06:52:28   Epoch[19](1/5): current batch triplet loss = 0.0099, average epoch triplet loss = 0.0420
2022-01-16 06:52:28   Cache: 2 / 5
2022-01-16 06:55:21   Epoch[19](2/5): current batch triplet loss = 0.0480, average epoch triplet loss = 0.0423
2022-01-16 06:55:21   Cache: 3 / 5
2022-01-16 06:58:13   Epoch[19](3/5): current batch triplet loss = 0.0258, average epoch triplet loss = 0.0421
2022-01-16 06:58:13   Cache: 4 / 5
2022-01-16 07:01:07   Epoch[19](4/5): current batch triplet loss = 0.0231, average epoch triplet loss = 0.0421
2022-01-16 07:01:07   Finished epoch 19 in 0:14:23, average epoch triplet loss = 0.0421
2022-01-16 07:01:07   Extracting database features for evaluation/testing
2022-01-16 07:01:42   Extracting queries features for evaluation/testing
2022-01-16 07:02:24   Calculating recalls
2022-01-16 07:02:52   Recalls on val set < BaseDataset, pitts30k - #database: 10000; #queries: 7608 >: R@1: 87.2, R@5: 95.6, R@10: 97.4, R@20: 98.4
2022-01-16 07:02:52   Improved: previous best R@5 = 95.4, current R@5 = 95.6
2022-01-16 07:02:52   Best R@5: 95.6
2022-01-16 07:02:52   Trained for 20 epochs, in total in 5:24:52
2022-01-16 07:02:52   Extracting database features for evaluation/testing
2022-01-16 07:03:27   Extracting queries features for evaluation/testing
2022-01-16 07:03:55   Calculating recalls
2022-01-16 07:04:18   Recalls on < BaseDataset, pitts30k - #database: 10000; #queries: 6816 >: R@1: 84.9, R@5: 92.8, R@10: 94.8, R@20: 96.3
